/* jQuery.fn.filterTable v 1.0  -- (c) 2009-2016 HugsmiÃ°jan ehf.  @preserve */
!function(t){var e=8>parseInt((/MSIE ([\w.]+)/.exec(navigator.userAgent)||[])[1],10),a=function(e,a){if(e=t(e).filter("table").eq(0),!a.thead&&!e.find("thead").length){var i=e.find("tbody"),n=t("<thead />").insertBefore(i[0]);i.find("tr").each(function(e){var a=t(this),i=a.find("td");{if((!a.find("th").length||i.length&&0!==e)&&!l(i))return!1;a.appendTo(n)}})}},i=function(){},n=t.beget||function(e,a){return i.prototype=e,a?t.extend(new i,a):new i},l=function(e){return!t(e).clone().find(">b, >strong").remove().end().text().replace(/\s/g,"")},s=function(e){return e=t(e),{cols:parseInt("0"+e.attr("colspan"),10)||1,rows:parseInt("0"+e.attr("rowspan"),10)||1}},r=function(e){t(this).data(w).input.val("").trigger("change").trigger("focus"),e.stopPropagation()},c=function(){this.select()},o=function(e){var a=t(this);a.closest("td, th").toggleClass(a.data(w).cfg.fieldFocusClass,"focus"===e.type)},f=function(e,a,i){t(e).each(function(){var e=t(this);a.hideRowClass?e.toggleClass(a.hideRowClass,!i):i?e.css("display",""):e.hide()})},d=function(t,e){f(t,e,!0)},h=function(t,e){f(t,e,!1)},u=function(){var e=t(this),a=e.data(w);clearTimeout(a._searchThread),a._searchThread=setTimeout(function(){p(e)},a.cfg.delay)},p=function(e){var a=e.val(),i=e.data(w),n=i.lastValue,l=i.cfg,s=l.activeColClass;delete i._searchThread,a&&!n&&(l.multiFilter||i.allInputs.not(e).each(function(){var e=this,a=t(e).data(w);e.value&&(this.value=a.lastValue="",b(i,a.idx,s,!1))})),i.lastValue=a,b(i,i.idx,s,a.length>=l.minChars),a!==n&&g(i),i.table_head.useCellMapCache=0},g=function(e){v(e);var a,i=e.cfg,n=e.table.find("tbody"),l=n.find("tr");i.isStickyRow&&(l=l.filter(function(){var e=t(this).filter(i.isStickyRow);return d(e,i),!e.length})),i.isHideRow&&(l=l.filter(function(){var e=t(this).filter(i.isHideRow);return h(e,i),!e.length})),e.allInputs.each(function(e){var n=t(this),s=n.data(w);if(s.lastValue){a=1;var r=t.trim(this.value);r=i.matchCase?r:r.toLowerCase(),r=r.length>=i.minChars?r:"",l.each(function(){var a=t(this),l=a.data(y)[e];f(a,i,l&&i.cellMatches(l,r,s,n.is("select")))}),l=l.filter(":visible")}}),a||d(n.find("tr"),i),e.table_head.closest("table").toggleClass(i.activeTableClass,!!a),e.table.trigger("filter.filterTable")},v=function(e){var a=e.table_head;if(!a.useCellMapCache){var i=[];a.find("tr").each(function(){var e=0,a=[];t(this).data(y,a).children().each(function(){for(;i[e];)i[e++]--;var t=this,n=s(t),l=n.cols;for(a[e]=t;l--;)i[e]=n.rows-1,e++}),a.length=e}),a.useCellMapCache=1}},b=function(e,a,i,n){v(e),e.table_head.find("tr").map(function(){return t(this).data(y)[a]||null}).toggleClass(i,n)},C=function(e){var a=e.data().filterTable,i=[],n="is"===t(a.table).lang()&&"function"==typeof i.sortISL?"sortISL":"sort";t(a.table).find("tbody tr").each(function(){var e=t.trim(t(this).find("td:eq("+a.idx+")").text());e.length&&i.push(e)}),i=t.uniqueArray(i[n](),!0);for(var l=0;l<i.length;l++)e.append("<option>"+i[l]+"</option>")},w="filterTable",y=w+"-cellMap",m=function(i){if(this.length){var l=this.filter("table").add(this.find("table"));if(l.length){i=n(m.defaults,i);var f=t(i.filterRow),d=t(i.inputField).bind("focus",c).bind("focus blur",o).bind("change keyup",u),h=t(i.selectField).bind("focus blur",o).bind("change keyup",u),p=t(i.clearBtn).bind("click",r),g=t(i.filterCell),v=g.clone(!0).empty().append(d),b=g.clone(!0).empty().append(h);l.each(function(){a(this,i);var l=t(this),r=l.find("tbody tr"),c=i.thead?t(i.thead):l.find("thead"),o=c.find("tr"),d=f.clone(!0),h=!o.length,u={cfg:i,table:l,table_head:t(l.add(i.thead))},y=[],m=[];if((o=h?r.eq(0):o).each(function(){var a=0;t(">*",this).each(function(i,n){for(;m[a];)m[a++]--;var l=s(n),r=l.cols;for(e&&t(n).attr("rowspan",l.rows),y[a]=n;r--;)y[a]=y[a]||n,m[a]=l.rows-1,a++})}),y=t(y).each(function(e){var a=t(this),l=a.is("."+i.selectFilterClass);m[e]&&a.attr("rowspan",o.length);var s=p.clone(!0),r=n(u,{idx:e,btn:s}),c=(!a.filter(i.includeCols).length&&!h||l?(a.filter(i.includeCols).length||h)&&l?b:g:v).clone(!0).appendTo(d).find("input, select").data(w,r).after(s);l&&C(c),s.data(w,{input:c})}),u.allInputs=d.find("input, select"),d.appendTo(c),i.fixColWidths){var T=[],x=0;d.find(">*").each(function(e){var a=parseInt(t(this).width(),10);T[e]=a,x+=a}).each(function(e){t(this).css({width:100*T[e]/x+"%"})})}})}}return this};m.defaults={fixColWidths:!0,filterRow:'<tr class="filters" />',filterCell:"<td>&nbsp;</td>",inputField:"<input />",selectField:'<select><option value=""></option></select>',clearBtn:'<span class="clearfilter"/>',activeTableClass:"filters-active",fieldFocusClass:"filter-focus",activeColClass:"filter-col",selectFilterClass:"select-filter",includeCols:function(){return t(this).is("th")||l(this)},cellMatches:function(e,a,i,n){var l,s=t(e).text()||"",r=i.cfg;return s=r.matchCase?s:s.toLowerCase(),l=n?t.trim(s)===t.trim(a)?1:-1:s.indexOf(a),r.substrSearch?l>-1:!l},substrSearch:!0,minChars:2,delay:300},t.fn.filterTable=m}(window.jQuery);
