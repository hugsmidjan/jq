// jQuery.fn.elastic 1.6.11 -- MIT licence -- http://www.unwrongest.com/projects/elastic/
(function(o){jQuery.fn.extend({elastic:function(){var i=['paddingTop','paddingRight','paddingBottom','paddingLeft','fontSize','lineHeight','fontFamily','width','fontWeight','border-top-width','border-right-width','border-bottom-width','border-left-width','borderTopStyle','borderTopColor','borderRightStyle','borderRightColor','borderBottomStyle','borderBottomColor','borderLeftStyle','borderLeftColor'];return this.each(function(){if(this.type!=='textarea'){return false}var a=jQuery(this),b=jQuery('<div />').css({'position':'absolute','display':'none','word-wrap':'break-word','white-space':'pre-wrap'}),j=parseInt(a.css('line-height'),10)||parseInt(a.css('font-size'),'10'),f=parseInt(a.css('height'),10)||j*3,d=parseInt(a.css('max-height'),10)||Number.MAX_VALUE,p=0;if(d<0){d=Number.MAX_VALUE}b.appendTo(a.parent());var k=i.length;while(k--){b.css(i[k].toString(),a.css(i[k].toString()))}function n(){var c=Math.floor(parseInt(a.width(),10));if(b.width()!==c){b.css({'width':c+'px'});e(true)}}function l(c,g){var h=Math.floor(parseInt(c,10));if(a.height()!==h){a.css({'height':h+'px','overflow':g})}}function e(c){var g=a.val().replace(/&/g,'&amp;').replace(/ {2}/g,'&nbsp;').replace(/<|>/g,'&gt;').replace(/\n/g,'<br />');var h=b.html().replace(/<br>/ig,'<br />');if(c||g+'&nbsp;'!==h){b.html(g+'&nbsp;');if(Math.abs(b.height()+j-a.height())>3){var m=b.height()+j;if(m>=d){l(d,'auto')}else if(m<=f){l(f,'hidden')}else{l(m,'hidden')}}}}a.css({'overflow':'hidden'});a.bind('keyup change cut paste',function(){e()});o(window).bind('resize',n);a.bind('resize',n);a.bind('update',e);a.bind('blur',function(){if(b.height()<d){if(b.height()>f){a.height(b.height())}else{a.height(f)}}});a.bind('input paste',function(c){setTimeout(e,250)});e()})}})})(jQuery);
