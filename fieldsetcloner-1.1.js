// jQuery.fn.fieldsetCloner v 1.1 - (c) 2011-2013 Hugsmiðjan ehf
!function(e,a){e.fn.fieldsetCloner=a=function(t){return this.each(function(){var n=e(this),r=a.i18n[n.closest("[lang]").attr("lang")]||a.i18n.en,d=e.extend({},a.defaults,r,t);d.rowName=(n.attr(d.rowNameSel||"")||n.find(d.rowNameSel).eq(0).text()||d.rowName).replace(/:/g,"");d.$protoFS=n.clone(!!d.cloneEvents).each(function(){var a=e.trim(this.className);a&&(a=(a+" ").replace(/\s+/g,"-"+d.cloneClass+" ")+a);a+=" "+d.cloneClass;this.className=a});d.$delBtn=d.addDelBtn&&e(d.delBtnTemplate.replace(/%\{className\}/g,d.delBtnClass).replace(/%\{label\}/g,d.delBtnLabel).replace(/%\{tooltip\}/g,d.delBtnTitle+d.rowName)).on("click",function(a){a.preventDefault();var t=e(this).data("$fsclnr");t.slideUp(d.showSpeed,function(){t.remove()});if(d.$place==="appendTo"){t.find("."+d.addBtnClass)[d.$place](t.prev())}}),d.$place={after:"insertAfter",bottom:"appendTo"}[d.buttonPlacement]||"insertAfter";d.$num=1;e(d.addBtnTemplate.replace(/%\{className\}/g,d.addBtnClass).replace(/%\{label\}/g,d.addBtnLabel+d.rowName).replace(/%\{tooltip\}/g,d.addBtnTitle+d.rowName))[d.$place](n).on("click",function(a){a.preventDefault();var t=e(this),n=d.$place==="appendTo",r=n?t.parent():t.prev(),s;n&&t.detach();s=l(d).hide().insertAfter(r).slideDown(d.showSpeed);n&&t[d.$place](s);d.afterClone&&d.afterClone(s)})})};a.defaults={buttonPlacement:"after",addBtnTemplate:'<a class="%{className}" href="#" title="%{tooltip}">%{label}</a>',addBtnClass:"addrow",cloneClass:"clone",showSpeed:"fast",delBtnTemplate:'<a class="%{className}" href="#" title="%{tooltip}">%{label}</a>',delBtnClass:"delrow"};a.i18n={en:{addBtnLabel:"Add ",addBtnTitle:"Add new ",delBtnLabel:"Delete",delBtnTitle:"Delete this ",rowName:"row"},is:{addBtnLabel:"Bæta við ",addBtnTitle:"Bæta við auka ",delBtnLabel:"Eyða",delBtnTitle:"Eyða þessari ",rowName:"röð"}};var t=8>parseInt((/MSIE ([\w.]+)/.exec(navigator.userAgent)||[])[1],10),l=function(a){var l=a.$protoFS.clone(!!a.cloneEvents),n,r,d="-"+(a.cloneClass||"clone")+"-",s=new RegExp("("+d+"\\d+)?$");d+=a.$num++;if(a.$delBtn){a.$delBtn.clone(true).data("$fsclnr",l).appendTo(l.find(a.delBtnAppendTo).add(l).last())}if(n=l[0].id){l[0].id=n.replace(s,d)}l.find("*").each(function(){var a=this;if(n=a.id){a.id=n.replace(s,d)}if(n=e(a).attr("for")){e(a).attr("for",n.replace(s,d))}if(n=a.name){var l=n.match(/^(.*)(\d+)(\D*)$/);a.name=l?l[1]+(parseInt(l[2],10)+1)+l[3]:n+"-2"}if(t&&/^(?:INPUT|SELECT|TEXTAREA|BUTTON)$/.test(a.tagName)){var r=e(a.outerHTML.replace(/( name=)[^ >]+/,'$1"'+n+'"'));e(a).replaceWith(r)}});return l}}(jQuery);
