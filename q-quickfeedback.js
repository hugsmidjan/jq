/* jQuery quickFeedback 1.0  -- (c) 2014 Hugsmiðjan ehf.  @preserve */
!function(e){e.quickFeedback={i18n:{en:{qfeedbackThanks:"That was nice. Thanks!",qfeedbackClose:"Hide"},is:{qfeedbackThanks:"Gott að vita. Takk!",qfeedbackClose:"Fela"}}},e.fn.quickFeedback=function(n){return n=e.extend({gaPing:!0,yayBtnSel:"a.yay",nayBtnSel:"a.nay",ajaxParams:{justPicPos:"pgmain"},feedbackformSel:".quickfeedback",thankyouSel:".thankyou",logShortPaths:!1},n),this.each(function(){var a=e(this),t=e.quickFeedback.i18n[a.lang()]||e.quickFeedback.i18n.is,i=n.logShortPaths?document.location.pathname:document.location.href;a.on("click",n.yayBtnSel,function(e){var o=this.getAttribute("data-thankstext")||t.qfeedbackThanks;e.preventDefault(),a.addClass("submitted").pause(200,function(){a.html('<strong class="thanks">'+o+"</strong>").focusHere()}).pause(4e3).fadeOut(1e3,function(){a.remove()}),n.gaPing&&window.ga.eventPing("quickfeedback","clicked-yes",i,1,!1)}).on("click",n.nayBtnSel,function(o){o.preventDefault();var c,d=this;e.get(d.href,n.ajaxParams).done(function(o){var d=e(o),s=d.find(n.feedbackformSel).append(d.filter("script[data-spm]")),f=s[0].getAttribute("data-hidetext")||t.qfeedbackClose;e('<a class="action cancel" role="button" href="#">'+f+"</a>").on("click",function(e){e.preventDefault(),s.pause(200).fadeOut(500,function(){s.remove()})}).insertAfter(s.find(".fi_btn"));var u,r=s.is("form")?s:s.find("form:first");r.on("submit",function(){u=!!s.find("input:checked")[0]||!!s.find("textarea").val()}),s.hide().insertAfter(a).fadeIn(500,function(){s.focusHere()}),a.detach();var l=s.find(".resp_email");l.length&&l.find('[name="send_response"]').on("change",function(){l[e(this).is(":checked")?"addClass":"removeClass"]("email-active")}),e(document).trigger("domupdated",[s]),s.find(".boxbody").on("VBload",function(e,n){n.resultDOM.find("h1, h2").detach(),n.resultDOM=n.resultDOM.find(".boxbody").contents()}).on("VBloaded",function(){u&&(n.gaPing&&window.ga.eventPing("quickfeedback","clicked-no",i,1,!1),c=!0),s.pause(4e3).fadeOut(1e3,function(){s.remove()})}).virtualBrowser({params:n.ajaxParams,loadmsgMode:"replace",selector:n.thankyouSel})}),e(window).on("unload beforeunload",function(){!c&&n.gaPing&&window.ga.eventPing("quickfeedback","clicked-no-only",i,1,!1),c=!0})})})}}(window.jQuery);
