/* jQuery quickFeedback 1.0  -- (c) 2014 Hugsmiðjan ehf.  @preserve */
!function(r){r.quickFeedback={i18n:{en:{qfeedbackThanks:"That was nice. Thanks!",qfeedbackClose:"Hide"},is:{qfeedbackThanks:"Gott að vita. Takk!",qfeedbackClose:"Fela"}}},r.fn.quickFeedback=function(u){return u=r.extend({gaPing:!0,yayBtnSel:"a.yay",nayBtnSel:"a.nay",ajaxParams:{justPicPos:"pgmain"},feedbackformSel:".quickfeedback",thankyouSel:".thankyou",logShortPaths:!1},u),this.each(function(){var d=r(this),a=this.className.split(" ")[0],s=r.quickFeedback.i18n[d.lang()]||r.quickFeedback.i18n.is,f=u.logShortPaths?document.location.pathname:document.location.href;d.on("click",u.yayBtnSel,function(e){var n=this.getAttribute("data-thankstext")||s.qfeedbackThanks;e.preventDefault(),d.addClass("submitted").pause(200,function(){d.html('<strong class="thanks '+a+'__thanks">'+n+"</strong>").focusHere()}).pause(4e3).fadeOut(1e3,function(){d.remove()}),u.gaPing&&window.gaHXM.eventPing("quickfeedback","clicked-yes",f,1,!1)}).on("click",u.nayBtnSel,function(e){e.preventDefault();var c;r.get(this.href,u.ajaxParams).done(function(e){var n,a=r(e),t=a.find(u.feedbackformSel).append(a.filter("script[data-spm]")),i=t[0].getAttribute("data-hidetext")||s.qfeedbackClose;r('<a class="action cancel" role="button" href="#">'+i+"</a>").on("click",function(e){e.preventDefault(),t.pause(200).fadeOut(500,function(){t.remove()})}).insertAfter(t.find(".fi_btn")),(t.is("form")?t:t.find("form:first")).on("submit",function(){n=!!t.find("input:checked")[0]||!!t.find("textarea").val()}),t.hide().insertAfter(d).fadeIn(500,function(){t.focusHere()}),d.detach();var o=t.find(".resp_email");o.length&&o.find('[name="send_response"]').on("change",function(){o[r(this).is(":checked")?"addClass":"removeClass"]("email-active")}),r(document).trigger("domupdated",[t]),t.find(".boxbody").on("VBload",function(e,n){n.resultDOM.find("h1, h2").detach(),n.resultDOM=n.resultDOM.find(".boxbody").contents()}).on("VBloaded",function(){n&&(u.gaPing&&window.gaHXM.eventPing("quickfeedback","clicked-no",f,1,!1),c=!0),t.pause(4e3).fadeOut(1e3,function(){t.remove()})}).virtualBrowser({params:u.ajaxParams,loadmsgMode:"replace",selector:u.thankyouSel})}),r(window).on("unload beforeunload",function(){!c&&u.gaPing&&window.gaHXM.eventPing("quickfeedback","clicked-no-only",f,1,!1),c=!0})})})}}(window.jQuery);
