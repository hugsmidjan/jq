// $.fn.visualImageMap 1.0  -- (c) 2010 Hugsmi√∞jan ehf.
!function(t,a){var e="visualImageMap",r=parseFloat,i=parseInt,o="usemap",s="usemapElm";t.fn[e]=function(a){a=t.extend({overlay:'<div class="imgoverlay" />',area:'<a class="area"/>'},a);this.each(function(){var e=t(this),n=(e.attr(o)||"").substr(1),d=n?t('map[name="'+n+'"]').detach():e.data(s)||[];if(d[0]){t(e.data(o+"overlay")||[]).remove();e.removeAttr(o).data(s,d);var p,h=d.data(o+"Sz")||[],l=h[0]||i(e.attr("width"),10)||(p=e.clone().appendTo("body")).width(),c=h[1]||i(e.attr("height"),10)||(p=p||e.clone().appendTo("body")).height(),f=e.width()/l,u=e.height()/c,v,m=t(a.area),g=t(a.overlay).insertAfter(e).css({position:"absolute",top:e.position().top+r(e.css("padding-top"))+r(e.css("border-top-width")),left:e.position().left+r(e.css("padding-left"))+r(e.css("border-left-width"))});p&&p.detach();e.data(o+"overlay",g);if(!h.length&&l&&c){d.data(o+"Sz",[l,c])}d.find("area").each(function(){var a=t(this),e=a.attr("title"),r=t.map(a.attr("coords").split(","),function(t){return i(t,10)}),o=m.clone(true);if(!v){o.prependTo(g);v=[i(o.css("margin-left"),10)||0,i(o.css("margin-top"),10)||0]}o.text(e).attr({href:a.attr("href"),title:e}).css({position:"absolute",left:r[0]*f+v[0],top:r[1]*u+v[1],width:(r[2]-r[0])*f,height:(r[3]-r[1])*u}).prependTo(g)})}});return this}}(jQuery);
