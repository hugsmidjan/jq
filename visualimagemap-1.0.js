// encoding: utf-8
// $.fn.visualImageMap 1.0  -- (c) 2010 Hugsmi√∞jan ehf.
(function(b,w){var t='visualImageMap',h=parseFloat,e=parseInt,c='usemap';b.fn[t]=function(i){i=b.extend({overlay:'<div class="imgoverlay" />',area:'<a class="area"/>'},i);this.each(function(){var a=b(this),m=(a.attr(c)||'').substr(1),f=m?b('map[name="'+m+'"]').detach():a.data(c+'Elm')||[];if(f[0]){b(a.data(c+'overlay')||[]).remove();a.removeAttr(c).data(c+'Elm',f).one('load',function(x){var g,n=f.data(c+'Sz')||[],o=n[0]||e(a.attr('width'),10)||(g=a.clone().appendTo('body')).width(),p=n[1]||e(a.attr('height'),10)||(g=(g||a.clone().appendTo('body'))).height(),q=a.width()/o,r=a.height()/p,j,u=b(i.area),k=b(i.overlay).insertAfter(a).css({position:'absolute',top:a.position().top+h(a.css('padding-top'))+h(a.css('border-top-width')),left:a.position().left+h(a.css('padding-left'))+h(a.css('border-left-width'))});g&&g.detach();a.data(c+'overlay',k);f.data(c+'Sz',[o,p]);f.find('area').each(function(y){var l=b(this),s=l.attr('title'),d=b.map(l.attr('coords').split(','),function(v,z){return e(v,10)});areaElm=u.clone(true);if(!j){areaElm.prependTo(k);j=[e(areaElm.css('margin-left'),10)||0,e(areaElm.css('margin-top'),10)||0]}areaElm.text(s).attr({href:l.attr('href'),title:s}).css({position:'absolute',left:d[0]*q+j[0],top:d[1]*r+j[1],width:(d[2]-d[0])*q,height:(d[3]-d[1])*r}).prependTo(k)})});if(a[0].width){a.trigger('load')}}});return this}})(jQuery);
