// encoding: utf-8
// $.fn.visualImageMap 1.0  -- (c) 2010 Hugsmi√∞jan ehf.
(function(b,v){var q='visualImageMap',g=parseFloat,e=parseInt,c='usemap';b.fn[q]=function(h){h=b.extend({overlay:'<div class="imgoverlay" />',area:'<a class="area"/>'},h);this.each(function(){var a=b(this),m=(a.attr(c)||'').substr(1),j=m?b('map[name="'+m+'"]').detach():a.data(c+'Elm')||[];if(j[0]){b(a.data(c+'overlay')||[]).remove();a.removeAttr(c).data(c+'Elm',j).one('load',function(w){var f,r=e(a.attr('width'),10)||(f=a.clone().appendTo('body')).width(),s=e(a.attr('height'),10)||(f=(f||a.clone().appendTo('body'))).height(),n=a.width()/r,o=a.height()/s,i,t=b(h.area),k=b(h.overlay).insertAfter(a).css({position:'absolute',top:a.position().top+g(a.css('padding-top'))+g(a.css('border-top-width')),left:a.position().left+g(a.css('padding-left'))+g(a.css('border-left-width'))});f&&f.detach();a.data(c+'overlay',k);j.find('area').each(function(x){var l=b(this),p=l.attr('title'),d=b.map(l.attr('coords').split(','),function(u,y){return e(u,10)});areaElm=t.clone(true);if(!i){areaElm.prependTo(k);i=[e(areaElm.css('margin-left'),10)||0,e(areaElm.css('margin-top'),10)||0]}areaElm.text(p).attr({href:l.attr('href'),title:p}).css({position:'absolute',left:d[0]*n+i[0],top:d[1]*o+i[1],width:(d[2]-d[0])*n,height:(d[3]-d[1])*o}).prependTo(k)})});if(a[0].width){a.trigger('load')}}});return this}})(jQuery);
