// encoding: utf-8
// $.fn.jsgallery 1.0 -- (c) 2009 Hugsmiðjan ehf. 
(function($){$.fn.jsgallery=function(b){var c={en:{nextText:'Next image',prevText:'Previous image',imgText:'Image',ofText:'of'},is:{nextText:'Næsta mynd',prevText:'Fyrri mynd',imgText:'Mynd',ofText:'af'}};b=$.extend({fadeInSpeed:150,curtColor:'#000000',curtOpacity:'0.7',smallImgSize:'preview',medImgSize:'medium',largeImgSize:'large',showTitles:true,paging:true,loop:true},b);var d=$(this),txt=txt||c[d.closest('[lang]').attr('lang')]||c.en,imgLinks=$('li a',d),idxLength=imgLinks.length,currentIdx=0,newIdx=0,imgTemplate=$('<div class="imgbox">'+'<div class="img">'+'<a href="">'+'<img src="" title="" alt="" />'+'</a>'+'</div>'+'<div class="imgcontent">'+'<div class="imgname"></div>'+'<div class="imgtext"></div>'+'</div>'+'</div>'),updateImg=function(){var a=imgLinks[newIdx],popHref=a.href.replace('/'+b.medImgSize+'/','/'+b.largeImgSize+'/'),titleTxt=$('img',a)[0].title||'',altTxt=$('img',a)[0].alt||'';$('div.img',imgTemplate).find('> a').hide().attr('href',popHref).find('> img').attr('src',a).attr('title',titleTxt).attr('alt',altTxt).end().fadeIn(b.fadeInSpeed);if(b.showTitles){$('div.imgname',imgTemplate).html(titleTxt);$('div.imgtext',imgTemplate).html(altTxt)}if(b.paging){$('.status b',imgTemplate).html(newIdx+1)}$(imgLinks[currentIdx]).parent().removeClass('current');$(imgLinks[newIdx]).parent().addClass('current');currentIdx=newIdx},nextImg=function(){if(newIdx!=idxLength-1){newIdx++;updateImg()}else if(b.loop&&newIdx==idxLength-1){newIdx=0;updateImg()}},prevImg=function(){if(newIdx!==0){newIdx--;updateImg()}else if(b.loop&&newIdx===0){newIdx=idxLength-1;updateImg()}};imgLinks.each(function(i){$(this).attr('href',$('img',this)[0].src.replace('/'+b.smallImgSize+'/','/'+b.medImgSize+'/')).bind('click',function(){newIdx=i-1;nextImg();return false})});if(b.paging){$('<div class="paging">'+'<div class="status">'+'<strong>'+txt.imgText+'</strong> '+'<span><b>1</b> '+txt.ofText+' '+idxLength+'</span>'+'</div>'+'<ul class="stepper">'+'<li class="next"><a href="#" title="'+txt.nextText+'">'+txt.nextText+'</a></li>'+'<li class="prev"><a href="#" title="'+txt.prevText+'">'+txt.prevText+'</a></li>'+'</ul>'+'</div>').appendTo(imgTemplate).find('.next a').bind('click',function(){nextImg();return false}).end().find('.prev a').bind('click',function(){prevImg();return false})}updateImg();imgTemplate.insertBefore(d).find('div.img > a').imgPopper({curtainColor:b.curtColor,curtainOpacity:b.curtOpacity});$(document).bind('keyup',function(e){if(e.keyCode==37){prevImg()}if(e.keyCode==39){nextImg()}});return this}})(jQuery);
