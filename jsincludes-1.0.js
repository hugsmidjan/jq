// encoding: utf-8
// jQuery.fn.jsincludes 1.0 - MIT/GPL Licensed - More info: http://github.com/maranomynet/jsincludes/
(function(c){var l='jsincludes',i='virtualBrowser',m='disengage',y=function(e,a){if(a.isFirst){c(this).remove()[i](m)}},z=function(e,a){var d=c(this),g=d.data(i).cfg,b=a.resultDOM;if(g[m]){d.before(b).detach();setTimeout(function(){c('<div/>').append(d).empty()},999)}if(g.setFocus&&c.setFocus){b.setFocus()}},q=function(a){var d=c(this),g=d.data(l),b=g.link,f=g.vb,h=f.data(i).cfg,j=b[0].href.split('#')[1],k=h.selector;h.selector=b.attr('data-selectors')||(j&&'#'+j)||k;if(a){h.setFocus=1}g.vb.replaceAll(d)[i]('load',b);if(!h[m]){g.vb.one('VBloaded',function(e){h.selector=k})}a&&a.preventDefault()},s,t=function(e){clearTimeout(s);s=setTimeout(function(){u()},r.refresh)},p,v,n=[],u=function(e){e=e||[];p=p||c(window);var a=p.scrollTop()+p.height();if(e.length||a!=v){n.push.apply(n,e);var d=n.length,g=d-(e.length||d),b,f,h=[];while(d-->g){b=c(n[d]);f=b.data(l).vb.data(i).cfg;if(b.offset().top<a+(f.unseenBuffer||0)){q.call(b[0]);n.splice(d,1)}}v=a}},A,r=c.fn[l]=function(j){if(j=='refresh'){t()}else{var k=[],w=[],x=[];this.each(function(){var b=c(this),f=c.extend(new o(),o,j,{url:null});if(!b.data(l)){if(f[m]===true){f[m]='*'}var h=b.is('a')?b:b.find('a').not(f.noIncl);h.each(function(){var e=c(this),a=b;if(h.length>1){f=c.extend(new o(),o,j);e.insertBefore(a).addClass(a.attr('class'));a=e}var d=c('<div/>').bind('VBerror',y).one('VBloaded',z)[i](f),g={elm:a,link:e,vb:d};w.push(d[0]);a.add(d).data(l,g);if(a.is(f.lazyLoad||'')){x.push(a[0]);a.bind('click',q)}else if(!f.delayUnseen||a.is(f.forceLoad)){setTimeout(function(){q.call(a[0])},0)}else{k.push(a[0])}});if(h.length>1){b.remove()}}});if(k.length){setTimeout(function(){u(k)},0);c(window).bind('resize scroll',t)}}return{vbBodies:c(w),lazyElms:c(x)}},o=r.config=function(){};o.prototype={lazyLoad:'.lazyload',noIncl:'.no-include',loadingClass:'jsi-loading',unseenBuffer:100,forceLoad:'.forceload',disengage:'*'};r.refresh=100})(jQuery);
