// $.fn.anchorTags 1.0  -- (c) 2009-2013 Hugsmi√∞jan ehf.
(function(e){var a,t=document.location,s=t.hostname,l=t.port;var n=e.fn.anchorTags=function(s){s=s||{};var l=this.filter("[href]"),i=l.length,r=[];if(i){var c=e.extend({patterns:{}},n.config),o=s.localDomains||[],p,f=s.patterns,d=n.patterns;delete s.patterns;e.extend(c,s);if(c.usePatterns){e.each(c.usePatterns,function(e,a){d[a]&&(c.patterns[a]=d[a])})}else{e.extend(c.patterns,d)}e.extend(c.patterns,f);s.patterns=f;o=o.concat(c.baseDomains).join("|").replace(/\./g,"\\.").replace(/\\\\\./g,".");p=new RegExp("^(?:[a-z]{3,12})://(?:"+o+")(?:/|$)","i");while(i--){var h=l[i],g=e(h),x=h.href,C=h.protocol,u=0,m={a:{}};if(C==="mailto:"){g.addClass(c.emailClass);m.mailto=!0;++u}else if(C==="tel:"||C==="callto:"){g.addClass(c.telClass);m.tel=!0;++u}else{if(!/^(javascript|data):/.test(C)){if(C){var v=C==="https:",k=C==="http:";if(v){g.addClass(c.secureClass);m.secure=!0;++u}if(c.externalClass&&((k||v)&&!p.test(x)||!k&&!v&&t.protocol!==C)){g.addClass(c.externalClass);m.external=!0;++u}}if(!m.external&&c.internalClass){a=a||new RegExp("^(?:"+t.toString().replace(/^https?:/,"https?:").split("#")[0].replace(/\./g,"\\.")+")?#.","i");if(a.test(x)){g.addClass(c.internalClass);m.internal=!0;++u}}}for(var w in c.patterns){var $=c.patterns[w]||{},j=$.check||$,z=e.isFunction(j)?j(h,w):null;if(z||j.test(x)){g.addClass(z||$.tag||c.patternClassPrefix+w);(m.pattern||(m.pattern=[])).push(w);m.a[w]=!0;++u}}}if(u){r.push(g[0]);c.onTag&&c.onTag.call(c,g,m)}}}this.taggedAnchors=e(r);return this};n.config={baseDomains:s?[s+(l?":"+l:"")]:[],localDomains:[],emailClass:"mailto",telClass:"tel",externalClass:"external",internalClass:"withinpage",patternClassPrefix:"file_",secureClass:"secure"};n.patterns={image:{check:/\.(jpe?g|png|gif)($|#|\?)/i},audio:{check:/\.(mp3|wav|aac|wma|flac|ogg)($|#|\?)/i},video:{check:/\.(m(ov|pe?g|p4)|avi|wmv)($|#|\?)/i},pdf:{check:/\.(pdf)($|#|\?)/i},doc:{check:/\.(docx?|rtf|wri|odt|sxw)(#|$|\?)/i},xls:{check:/\.(xlsx?|csv|ods|sxc)(#|$|\?)/i},pack:{check:/\.(zip|rar|7z|gz)(#|$|\?)/i}}})(jQuery);
