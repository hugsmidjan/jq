(function(b){var i,h=document.location,p=h.hostname,q=h.port;var d=b.fn.anchorTags=function(e){var v=this,j=this.length;if(j){var a=b.extend({patterns:{}},d.config),f=e.localDomains,r,s=e.patterns;delete e.patterns;b.extend(a,e);if(a.usePatterns){b.each(a.usePatterns,function(w,t){a.patterns[t]=d.patterns[t]})}else{b.extend(a.patterns,d.patterns)}b.extend(a.patterns,s);e.patterns=s;f=(f.charAt?f.split(/\s*,\s*/):f).concat(a.baseDomains);r=new RegExp('^([a-z]{3,12}):\/\/('+f.join('|').replace(/\./g,'\.').replace(/\\\\\./g,'.')+')(/|$)','i');while(j--){var c=v[j],g=b(c),k=c.href,u=0;if(c.protocol=='mailto:'){g.addClass(a.emailClass)}else{if(c.protocol){var l=c.protocol=='https:';_isHttp=c.protocol=='http:';if(l){g.addClass(a.secureClass)}if(a.externalClass&&(((_isHttp||l)&&!r.test(k))||(!_isHttp&&!l&&h.protocol!=c.protocol))){g.addClass(a.externalClass);u=1}}if(!u&&a.internalClass){i=i||new RegExp("^("+h.toString().replace(/^https?:/,'https?:').split('#')[0].replace(/\./g,'\.')+")?#.",'i');i.test(k)&&g.addClass(a.internalClass)}for(var m in a.patterns){var n=a.patterns[m]||{},o=n.check||n;_0=b.isFunction(o)?o(c,m):null;if(_0||o.test(k)){g.addClass(n.tag||(_0&&_0.charAt&&_0)||(a.patternClassPrefix||'file_')+m)}}}}return this}};d.config={baseDomains:p?[p+(q?':'+q:'')]:[],localDomains:[],emailClass:'mailto',externalClass:'external',internalClass:'withinpage',secureClass:'secure'};d.patterns={image:{check:/\.(jpe?g|png|gif)($|#|\?)/i},audio:{check:/\.(mp3|wav|aac|wma|flac|ogg)($|#|\?)/i},video:{check:/\.(m(ov|pe?g|p4)|avi|wmv)($|#|\?)/i},pdf:{check:/\.(pdf)($|#|\?)/i},doc:{check:/\.(docx?|rtf|wri|odt|sxw)(#|$|\?)/i},xls:{check:/\.(xlsx?|csv|ods|sxc)(#|$|\?)/i}}})(jQuery);
