(function(d){var j,h=document.location,p=h.hostname,q=h.port;var i=d.fn.anchorTags=function(e){var u=this,k=this.length;if(k){var a=d.extend({patterns:{}},i.config),f=e.localDomains,r,s=e.patterns;delete e.patterns;d.extend(a,e);d.extend(a.patterns,i.patterns,s);e.patterns=s;f=(f.charAt?f.split(/\s*,\s*/):f).concat(a.baseDomains);j=j||new RegExp("^("+h.toString().replace(/^https?:/,'https?:').split('#')[0].replace(/\./g,'\.')+")?#.",'i');r=new RegExp('^([a-z]{3,12}):\/\/('+f.join('|').replace(/\./g,'\.').replace(/\\\\\./g,'.')+')(/|$)','i');while(k--){var b=u[k],g=d(b),l=b.href,t=0;if(b.protocol=='mailto:'){g.addClass(a.emailClass)}else{if(b.protocol){var m=b.protocol=='https:';_isHttp=b.protocol=='http:';if(m){g.addClass(a.secureClass)}if(a.externalClass&&(((_isHttp||m)&&!r.test(l))||(!_isHttp&&!m&&h.protocol!=b.protocol))){g.addClass(a.externalClass);t=1}}if(!t&&a.internalClass&&j.test(l)){g.addClass(a.internalClass)}for(var n in a.patterns){var c=a.patterns[n],o;if(c.splice){c=c[0];o=c[1]}if(c&&c.test(l)){g.addClass(o?o(b,c,n):n)}}}}return this}};i.config={baseDomains:p?[p+(q?':'+q:'')]:[],localDomains:[],emailClass:'mailto',externalClass:'external',internalClass:'withinpage',secureClass:'secure'};i.patterns={file_image:/\.(jpe?g|png|gif)($|#|\?)/i,file_audio:/\.(mp3|ogg|wav)($|#|\?)/i,file_video:/\.(m(ov|pg)|avi|wmv)($|#|\?)/i,file_pdf:/\.(pdf)($|#|\?)/i,file_doc:/\.(docx?|rtf|wri)(#|$|\?)/i}})(jQuery);
