// $.fn.scrollTable 1.1  -- (c) 2010-2014 HugsmiÃ°jan ehf.
(function(t,a){var e="scrollTable",s=function(e){var s=e.table;var i=s.find(">tbody>tr:visible").eq(0);if(i[0]){var r=i.children();var n=s.find(">thead,>tfoot");var o=[];var l=[];r.css("width","");n.show();if(e._init){e._scrlBW=e.tbWrap?Math.max(0,e.tbWrap.width()-s.outerWidth()):0}s.css("width","").css("table-layout","");r.each(function(a){var e=t(this);l[a]=e.outerWidth();o[a]=e.width()});r.each(function(a){t(this).width(o[a])});var c=parseInt(s.css("width"),10);s.css("width",c).css("table-layout","fixed");n.css("display","");e.clones.css("table-layout","");e.clones.find(">*>tr").each(function(){var a=0,s=t(this).children(),i=s.length-1;if(e._init&&e._scrlBW){s.last().css("padding-right",function(t,a){return parseInt(a,10)+e._scrlBW})}s.each(function(s){var r=t(this),n=parseInt(r.attr("colspan"),10)||1,o=0;var c=r.outerWidth()-r.width();while(n--){o+=l[a++]}r.width(o-c+(s===i?e._scrlBW:0))})});e.clones.css("width",c+e._scrlBW).css("table-layout","fixed");e._init=a}},i=function(s){var i=s.table;s.clones&&s.clones.remove();s.clones=i.children("thead, tfoot").map(function(){var n=t(this),o=this.tagName.toLowerCase(),l=n.clone().data(e+"-org",n),c=t(i[0].cloneNode(false));s._proxyEvents&&l.bind(s._proxyEvents,s,r);c.css("table-layout","fixed").attr("summary","Skip this table - it's for layout purposes only").append(n.is("thead")?n.prevAll("caption").clone():a).append(l).addClass(o+" "+s._cloneClass)["insert"+(o==="thead"?"Before":"After")](s.tbWrap||i);var d=c.add(c.find("*"));d.filter("[id]").each(function(){var a=this.id,e=a+(Math.random()+"").substr(2),s=t(this).attr("id",e);t.each({"input, select, textarea":"label[for",area:"img[usemap"},function(t,i){if(s.is(t)){c.find(i+'="'+a+'"]').attr(i.split("[")[1],e)}})});if(s._hasEvAttrs){t.each(s._proxyEvents.split(/\s+/),function(t,a){d.removeAttr("on"+a)})}return c[0]})},r=function(a){var s=this,i=a.data,r=t(s).data(e+"-org"),n=[],o=a.target;while(o!==s){n.unshift(o.tagName.toLowerCase()+":nth-child("+(t(o).index()+1)+")");o=o.parentNode}var l=">"+n.join(">"),c=t.Event(a.type);t.each(i._proxyEvProps,function(){c[this]=a[this]});r.find(l).trigger(c);a.stopPropagation();c.isDefaultPrevented()&&a.preventDefault()},n=[],o,l=function(){if(o){clearTimeout(o);o=setTimeout(c,75)}else{c()}},c=function(){var a=n.length;while(a--){var i=n[a],r=i.data(e);if(!r){n=n.splice(a,1)}s(r)}if(!n.length){t(window).unbind("resize.scrolltable")}};t.fn[e]=function(a,r){if(a==="refresh"){this.each(function(a){if((a=t(this).data(e))&&r&&r.reclone){i(a);a._init=1}});c()}else{a=t.extend({},t.fn[e].defaults,a);this.filter(function(){return!t(this).data(e)}).each(function(){var r=t(this),o=a.tbWrap?t(r.wrap(a.tbWrap).parent()):null,c={table:r,tbWrap:o,_cloneClass:a.cloneClass,_proxyEvents:a.proxyEvents,_proxyEvProps:a.proxyEvProps.split(/\s*,\s*/),_hasEvAttrs:a.hasEvAttrs,_init:1};if(a.wrap){c.wrap=t(a.wrap).data(e,c);(o||r).wrap(c.wrap)}i(c);r.css("margin",0).data(e,c);s(c);n.push(r);t(window).bind("resize.scrolltable",l)})}return this};t.fn[e].defaults={proxyEvents:"click focusin focusout mouseup mousedown",proxyEvProps:"pageX pageY which",wrap:'<div class="scrollable" />',tbWrap:'<div class="tbody"/>',cloneClass:"screen-only"}})(jQuery);
