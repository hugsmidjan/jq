/* $.fn.videoLinks 1.0  -- (c) 2011-2015 Hugsmi√∞jan ehf. @preserve */
!function(e){var a='<object id="video" width="%{vidwi}" height="%{vidhe}"><param name="movie" value="%{vidurl}"></param><param name="wmode" value="transparent"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="%{vidurl}" type="application/x-shockwave-flash" wmode="transparent" allowscriptaccess="always" allowfullscreen="true" width="%{vidwi}" height="%{vidhe}"></embed></object>',t='<iframe width="%{vidwi}" height="%{vidhe}" src="%{vidurl}" frameborder="0" scrolling="no" title="%{vidTitle}" allowfullscreen></iframe>',i='<video width="%{vidwi}" height="%{vidhe}" src="%{vidurl}" controls %{auto}><source src="%{vidurl}" type="video/%{mime}"></source></video>',o=function(e,a){var t=a?e/4*3:e/16*9;return Math.round(t)},r=function(){var r,d,c,m,v=e(this),u=v.data("playvideo_data"),n=u.videoHref,f=u.type,s="auto"!==u.cfg.vidWidth?u.cfg.vidWidth:u.contElm.width(),p="auto"!==u.cfg.vidHeight?u.cfg.vidHeight:o(s,u.cfg.aspect4x3),h="",y="",w=0,g="iframe";if("youtube"===f||"youtu"===f)c="youtube"===f?n.match(/(?:embed\/|watch\/?\?v=)([^&?\/]+)/i):n.match(/\.be\/(.+)$/),c=c&&c[1],h=u.cfg.autostart?"&autoplay=1":"",y=u.cfg.autoHide===!0?"":"&autohide="+u.cfg.autoHide,d=l+"//www.youtube.com/embed/"+c+"?rel=0&wmode=transparent"+h+y+u.cfg.filePlayerExtraParams,w=30;else if("vimeo"===f)c=n.match(/\/([0-9a-z]{5,10})\/?(?:[#?]|$)/i),c=c&&c[1],h=u.cfg.autostart?"&autoplay=1":"",d=l+"//player.vimeo.com/video/"+c+"?title=1&amp;byline=0&amp;portrait=0"+h+u.cfg.filePlayerExtraParams;else if("facebook"===f)c=n.match(/(?:\/v\/|[?&]v=)(\d{10,20})/),c=c&&c[1],d=l+"//www.facebook.com/video/embed?video_id="+c;else if("file"===f){var b=document.createElement("video"),P=!!b.canPlayType&&b.canPlayType("video/mp4").replace(/no/,""),E=!!b.canPlayType&&b.canPlayType("video/quicktime").replace(/no/,"");P&&/\.(mp4|m4v)(\?|$)/i.test(n)?(d=n,g="video",h=u.cfg.autostart?"autoplay":"",m="mp4"):E&&/\.mov(\?|$)/i.test(n)?(d=n,g="video",h=u.cfg.autostart?"autoplay":"",m="quicktime"):(h=u.cfg.autostart?"&autostart=true":"",d=u.cfg.filePlayerUrl+n+h+u.cfg.filePlayerExtraParams,g=u.cfg.filePlayerFrame,p+=u.cfg.filePlayerHeight)}else d=n;"iframe"===g?v.html(e.inject(t,{vidurl:d,vidwi:s,vidhe:p,vidTitle:u.vidCapt})):"video"===g?v.html(e.inject(i,{vidurl:d,vidwi:s,vidhe:p,auto:h})):"flash"===g&&v.html(e.inject(a,{vidurl:d,vidwi:s,vidhe:p})),u.cfg.useCaption&&v.append('<span class="videocaption">'+u.vidCapt+"</span>"),"flash"!==g&&"auto"===u.cfg.vidWidth&&e(window).on("resize",function(){r=u.contElm.width(),r!==s&&(s=r,s=u.contElm.width(),p=o(s,u.cfg.aspect4x3)+w,v.find("iframe,video").attr("height",p).attr("width",s))})},l=document.location.protocol;l="file:"===l?"http:":l,e.fn.videoLinks=function(a){var t=this;return t.length&&(a=e.extend({autostart:!1,vidWidth:"auto",vidHeight:"auto",aspect4x3:!1,useCaption:!0,type:null,autoHide:!0,filePlayerUrl:"/bitar/common/media/mediaplayer.swf?file=",filePlayerExtraParams:"",filePlayerHeight:20,filePlayerFrame:"flash"},a)),t.map(function(){var t=e(this),i=t.attr("href"),o=a.type||/\.youtube\.com/i.test(i)&&"youtube"||/\.(flv|mp4|m4v|mov)(\?|$)/i.test(i)&&"file"||/vimeo\.com/i.test(i)&&"vimeo"||/youtu\.be/i.test(i)&&"youtu"||/facebook\.com/i.test(i)&&"facebook"||void 0,l={cfg:a,videoHref:i,type:o,vidCapt:t.text()},d=t.wrap('<span class="videoblock" />').parent();for(l.contElm=e(d);l.contElm[0]&&"inline"===l.contElm.css("display");)l.contElm=e(l.contElm.parent());return d.data("playvideo_data",l).run(r),t.remove(),d[0]})}}(jQuery);
