// encoding: utf-8
// $.fn.videoLinks 1.0  -- (c) 2011 Hugsmi√∞jan ehf.
(function(h){var l='<object id="video" width="%{vidwi}" height="%{vidhe}"><param name="movie" value="%{vidurl}"></param><param name="wmode" value="transparent"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="%{vidurl}" type="application/x-shockwave-flash" wmode="transparent" allowscriptaccess="always" allowfullscreen="true" width="%{vidwi}" height="%{vidhe}"></embed></object>',m='<iframe title="YouTube video player" width="%{vidwi}" height="%{vidhe}" src="%{vidurl}" frameborder="0" allowfullscreen></iframe>',i=document.location.protocol,i=i=='file:'?'http:':i,n=function(j){var b=h(this),c=b.data('playvideo_data'),e=c.videoHref,f=c.type,g,a=false,d=c.videoHeight;if(f=='youtube'||f=='youtu'){var o=f=='youtube'?e.match(/(?:embed\/|watch\/?\?v=)([^&?\/]+)/i)[1]:e.match(/\/([0-9a-z]+)$/i)[1];g=i+'//www.youtube.com/embed/'+o+'?rel=0';d=d+30;a=true}else if(f=='vimeo'){var k=e.match(/\/([0-9a-z]{5,10})\/?(?:[#?]|$)/i)[1];g=i+'//player.vimeo.com/video/'+k+'?title=1&amp;byline=0&amp;portrait=0';a=true}else if(f=='facebook'){var k=e.match(/(\d{10,20})$/)[1];g=i+'//www.facebook.com/v/'+k}else if(f=='file'){var p=c.autostart?'autostart=true&':'';g='/bitar/common/media/mediaplayer.swf?'+p+'file='+e;d=d+20}if(a){b.html(h.inject(m,{vidurl:g,vidwi:c.videoWidth,vidhe:d}))}else{b.html(h.inject(l,{vidurl:g,vidwi:c.videoWidth,vidhe:d}))}b.append('<span class="videocaption">'+c.vidCapt+'</span>')};h.fn.videoLinks=function(a){var d=this;if(d.length){a=h.extend({vidWidth:'auto',vidHeight:'auto',aspect4x3:false},a);d.each(function(){var j=h(this),b=j.attr('href'),c=(/\.youtube\.com/i.test(b)&&'youtube')||(/\.(flv|mp4|m4v)(\?|$)/i.test(b)&&'file')||(/vimeo\.com/i.test(b)&&'vimeo')||(/youtu\.be/i.test(b)&&'youtu')||(/facebook\.com/i.test(b)&&'facebook')||undefined,e=(a.vidWidth=='auto')?j.closest('div, p').width():a.vidWidth,f=(a.vidHeight=='auto'&&a.aspect4x3)?(e/4)*3:(a.vidHeight=='auto'&&!a.aspect4x3)?(e/16)*9:a.vidHeight,g={videoHref:b,type:c,vidCapt:j.text(),videoWidth:e,videoHeight:Math.round(f),autostart:!!a.autostart};if(c){j.wrap('<span class="videoblock" />').parent().data('playvideo_data',g).run(n);j.remove()}})}return d}})(jQuery);
