// $.fn.videoLinks 1.0  -- (c) 2011 Hugsmi√∞jan ehf.
!function(e){var t='<object id="video" width="%{vidwi}" height="%{vidhe}"><param name="movie" value="%{vidurl}"></param><param name="wmode" value="transparent"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="%{vidurl}" type="application/x-shockwave-flash" wmode="transparent" allowscriptaccess="always" allowfullscreen="true" width="%{vidwi}" height="%{vidhe}"></embed></object>',i='<iframe title="YouTube video player" width="%{vidwi}" height="%{vidhe}" src="%{vidurl}" frameborder="0" allowfullscreen></iframe>',a='<video width="%{vidwi}" height="%{vidhe}" src="%{vidurl}" controls %{auto}><source src="%{vidurl}" type="video/%{mime}"></source></video>',o=function(e,t){var i=t?e/4*3:e/16*9;return Math.round(i)},d=function(){var d,l,v,u,c=e(this),m=c.data("playvideo_data"),n=m.videoHref,s=m.type,p="auto"!==m.vidWidth?m.vidWidth:m.contElm.width(),h="auto"!==m.vidHeight?m.vidHeight:o(p,m.aspect4x3),f="",w=0,y="iframe";if("youtube"===s||"youtu"===s)v=n.match("youtube"===s?/(?:embed\/|watch\/?\?v=)([^&?\/]+)/i:/\.be\/(.+)$/),v=v&&v[1],f=m.autostart?"&autoplay=1":"",l=r+"//www.youtube.com/embed/"+v+"?rel=0"+f,w=30;else if("vimeo"===s)v=n.match(/\/([0-9a-z]{5,10})\/?(?:[#?]|$)/i),v=v&&v[1],f=m.autostart?"&autoplay=1":"",l=r+"//player.vimeo.com/video/"+v+"?title=1&amp;byline=0&amp;portrait=0"+f;else if("facebook"===s)v=n.match(/(?:\/v\/|[?&]v=)(\d{10,20})/),v=v&&v[1],l=r+"//www.facebook.com/video/embed?video_id="+v;else if("file"===s){var b=document.createElement("video"),g=!!b.canPlayType&&b.canPlayType("video/mp4").replace(/no/,""),k=!!b.canPlayType&&b.canPlayType("video/quicktime").replace(/no/,"");g&&/\.(mp4|m4v)(\?|$)/i.test(n)?(l=n,y="video",f=m.autostart?"autoplay":"",u="mp4"):k&&/\.mov(\?|$)/i.test(n)?(l=n,y="video",f=m.autostart?"autoplay":"",u="quicktime"):(f=m.autostart?"&autostart=true":"",l="/bitar/common/media/mediaplayer.swf?file="+n+f,w=20,y="flash")}else l=n;h+=w,"iframe"===y?c.html(e.inject(i,{vidurl:l,vidwi:p,vidhe:h})):"video"===y?c.html(e.inject(a,{vidurl:l,vidwi:p,vidhe:h,auto:f})):"flash"===y&&c.html(e.inject(t,{vidurl:l,vidwi:p,vidhe:h})),m.useCaption&&c.append('<span class="videocaption">'+m.vidCapt+"</span>"),"flash"!==y&&"auto"===m.vidWidth&&e(window).on("resize",function(){d=m.contElm.width(),d!==p&&(p=d,p=m.contElm.width(),h=o(p,m.aspect4x3)+w,c.find("iframe,video").attr("height",h).attr("width",p))})},r=document.location.protocol;r="file:"===r?"http:":r,e.fn.videoLinks=function(t){var i=this;return i.length&&(t=e.extend({vidWidth:"auto",vidHeight:"auto",aspect4x3:!1,useCaption:!0},t)),i.map(function(){var i=e(this),a=i.attr("href"),o=/\.youtube\.com/i.test(a)&&"youtube"||/\.(flv|mp4|m4v|mov)(\?|$)/i.test(a)&&"file"||/vimeo\.com/i.test(a)&&"vimeo"||/youtu\.be/i.test(a)&&"youtu"||/facebook\.com/i.test(a)&&"facebook"||void 0,r={videoHref:a,type:o,vidCapt:i.text(),vidWidth:t.vidWidth,vidHeight:t.vidHeight,autostart:!!t.autostart,aspect4x3:t.aspect4x3,useCaption:t.useCaption},l=i.wrap('<span class="videoblock" />').parent();for(r.contElm=e(l);r.contElm[0]&&"inline"===r.contElm.css("display");)r.contElm=e(r.contElm.parent());return l.data("playvideo_data",r).run(d),i.remove(),l})}}(jQuery);
