// encoding: utf-8
// $.fn.videoLinks 1.0  -- (c) 2011 Hugsmi√∞jan ehf.
(function(i){var n='<object id="video" width="%{vidwi}" height="%{vidhe}"><param name="movie" value="%{vidurl}"></param><param name="wmode" value="transparent"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="%{vidurl}" type="application/x-shockwave-flash" wmode="transparent" allowscriptaccess="always" allowfullscreen="true" width="%{vidwi}" height="%{vidhe}"></embed></object>',o='<iframe title="YouTube video player" width="%{vidwi}" height="%{vidhe}" src="%{vidurl}" frameborder="0" allowfullscreen></iframe>',j=document.location.protocol,j=j=='file:'?'http:':j,p=function(k){var c=i(this),b=c.data('playvideo_data'),d=b.videoHref,f=b.type,g,a,h=false,l=b.videoHeight;if(f=='youtube'||f=='youtu'){var m=f=='youtube'?d.match(/(?:embed\/|watch\/?\?v=)([^&?\/]+)/i):d.match(/\.be\/(.+)$/);m=m&&m[1];a=b.autostart?'&autoplay=1':'';g=j+'//www.youtube.com/embed/'+m+'?rel=0'+a;l=l+30;h=true}else if(f=='vimeo'){var e=d.match(/\/([0-9a-z]{5,10})\/?(?:[#?]|$)/i);e=e&&e[1];a=b.autostart?'&autoplay=1':'';g=j+'//player.vimeo.com/video/'+e+'?title=1&amp;byline=0&amp;portrait=0'+a;h=true}else if(f=='facebook'){var e=d.match(/(\d{10,20})$/);e=e&&e[1];g=j+'//www.facebook.com/v/'+e}else if(f=='file'){a=b.autostart?'&autostart=true':'';g='/bitar/common/media/mediaplayer.swf?file='+d+a;l=l+20}if(h){c.html(i.inject(o,{vidurl:g,vidwi:b.videoWidth,vidhe:l}))}else{c.html(i.inject(n,{vidurl:g,vidwi:b.videoWidth,vidhe:l}))}c.append('<span class="videocaption">'+b.vidCapt+'</span>')};i.fn.videoLinks=function(a){var h=this;if(h.length){a=i.extend({vidWidth:'auto',vidHeight:'auto',aspect4x3:false},a);h.each(function(){var k=i(this),c=k.attr('href'),b=(/\.youtube\.com/i.test(c)&&'youtube')||(/\.(flv|mp4|m4v)(\?|$)/i.test(c)&&'file')||(/vimeo\.com/i.test(c)&&'vimeo')||(/youtu\.be/i.test(c)&&'youtu')||(/facebook\.com/i.test(c)&&'facebook')||undefined,d=(a.vidWidth=='auto')?k.closest('div, p').width():a.vidWidth,f=(a.vidHeight=='auto'&&a.aspect4x3)?(d/4)*3:(a.vidHeight=='auto'&&!a.aspect4x3)?(d/16)*9:a.vidHeight,g={videoHref:c,type:b,vidCapt:k.text(),videoWidth:d,videoHeight:Math.round(f),autostart:!!a.autostart};if(b){k.wrap('<span class="videoblock" />').parent().data('playvideo_data',g).run(p);k.remove()}})}return h}})(jQuery);
