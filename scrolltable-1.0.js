// $.fn.scrollTable 1.0  -- (c) 2010 HugsmiÃ°jan ehf.
(function(c,q){var j='scrollTable',r=function(g){var h=g.table,k=h.width(),n=g._0&&(g.tbWrap.width()-h.outerWidth()),e=h.find('>tbody>tr:first>*').css('width',''),o=h.find('>thead,>tfoot').show(),s=[],p=[];e.each(function(a){var b=c(this);p[a]=b.outerWidth();s[a]=b.width()}).each(function(a){var b=p[a]-s[a];c(this).width(p[a]-b)});o.css('display','');g.clones.width(k+n);g.clones.find('>*>tr').each(function(){var l=0,f=c(this).children();f.each(function(){var a=c(this),b=a.data('padWidth'),d=(parseInt(a.attr('colspan'),10)||1),i=0;if(b===q){b=a.outerWidth()-a.width();a.data('padWidth',b)}while(d--){i+=p[l++]}a.width(i-b)});if(g._0){f.last().css('padding-right',function(a,b){return parseInt(b,10)+n})}});g._0=q},t=function(e){var o=e.table;e.clones&&e.clones.remove();e.clones=o.children('thead, tfoot').map(function(){var f=c(this),g=this.tagName.toLowerCase(),h=f.clone().data(j+'-org',f),k=c(o[0].cloneNode(false));e._1&&h.bind(e._1,e,v);k.attr('summary','Skip this table - it\'s for layout purposes only').append(f.is('thead')?f.prevAll('caption').clone():q).append(h).addClass(g+' '+(e._2))['insert'+(g==='thead'?'Before':'After')](e.tbWrap);var n=k.find('*').add(k);n.filter('[id]').each(function(){var d=this.id,i=d+(Math.random()+'').substr(2),l=c(this).attr('id',i);c.each({'input, select, textarea':'label[for','area':'img[usemap'},function(a,b){if(l.is(a)){k.find(b+'="'+d+'"]').attr(b.split('[')[1],i)}})});if(e._3){c.each(e._1.split(/\s+/),function(a,b){n.removeAttr('on'+b)})}return k[0]})},v=function(a){var b=this,d=a.data,i=c(b).data(j+'-org'),l=[],f=a.target;while(f!==b){l.unshift(f.tagName.toLowerCase()+':nth-child('+(c(f).index()+1)+')');f=f.parentNode}var g='>'+l.join('>'),h=c.Event(a.type);c.each(d._4,function(){h[this]=a[this]});i.find(g).trigger(h);a.stopPropagation();h.isDefaultPrevented()&&a.preventDefault()},m=[],u=function(){var a=m.length;while(a--){var b=m[a],d=b.data(j);if(!d){m=m.splice(a,1)}else if(b.is('html *')){r(d)}}if(!m.length){c(window).unbind('resize',u)}};c.fn[j]=function(d,i){if(d==='refresh'){i=i||{};this.each(function(a){if(a=c(this).data(j)){if(i.reclone){t(a);a._0=1}r(a)}})}else{d=c.extend({},c.fn[j].defaults,d);this.filter(function(){return!c(this).data(j)}).each(function(){var a=c(this),b={table:a,tbWrap:c(a.wrap(d.tbWrap).parent()),_2:d.cloneClass,_1:d.proxyEvents,_4:d.proxyEvProps.split(/\s*,\s*/),_3:d.hasEvAttrs,_0:1};if(d.wrap){b.wrap=c(d.wrap).data(j,b);b.tbWrap.wrap(b.wrap)}t(b);a.css('margin',0).data(j,b);r(b);m.push(a);c(window).bind('resize',u)})}return this};c.fn[j].defaults={proxyEvents:'click focusin focusout mouseup mousedown',proxyEvProps:'pageX pageY which',wrap:'<div class="scrollable" />',tbWrap:'<div class="tbody"/>',cloneClass:'screen-only'}})(jQuery);
