// encoding: utf-8
// $.fn.scrollTable 1.0  -- (c) 2010 HugsmiÃ°jan ehf.
(function(b,p){var j='scrollTable',q=function(f){var k=f.table,h=f._0&&(f.tbWrap.width()-k.outerWidth()),n=k.find('>tbody>tr:first>*').css('width',''),u=k.find('>thead,>tfoot').show(),r=[],o=[];n.each(function(c){var a=b(this);o[c]=a.outerWidth();r[c]=a.width()}).each(function(c){var a=o[c]-r[c];b(this).width(o[c]-a)});u.css('display','');f.clones.find('>*>tr').each(function(){var g=0,l=b(this).children();l.each(function(c){var a=b(this),d=a.data('padWidth'),e=(parseInt(a.attr('colspan'),10)||1),i=0;if(d==p){d=a.outerWidth()-a.width();a.data('padWidth',d)}while(e--){i+=o[g++]}a.width(i-d)});if(f._0){l.last().css('padding-right',function(c,a){return parseInt(a,10)+h})}});f._0=p},s=function(h){var n=h.table;h.clones&&h.clones.remove();h.clones=n.children('thead, tfoot').map(function(){var g=b(this),l=this.tagName.toLowerCase(),f=g.clone().data(j+'-org',g),k=b(n[0].cloneNode(false));h._1&&f.bind(h._1,h,v);k.attr('summary','Skip this table - it\'s for layout purposes only').append(g.is('thead')?g.prevAll('caption').clone():p).append(f).addClass(l+' '+(h._2))['insert'+(l=='thead'?'Before':'After')](h.tbWrap).find('*').andSelf().filter('[id]').each(function(){var d=this.id,e=b.aquireId(d),i=b(this).attr('id',e);b.each({'input, select, textarea':'label[for','area':'img[usemap'},function(c,a){if(i.is(c)){k.find(a+'="'+d+'"]').attr(a.split('[')[1],e)}})});return k[0]})},v=function(c){var a=this,d=c.data,e=b(a).data(j+'-org'),i=[],g=c.target;while(g!=a){i.unshift(g.tagName.toLowerCase()+':nth-child('+(b(g).index()+1)+')');g=g.parentNode}var l='>'+i.join('>'),f=b.Event(c.type);b.each(d._3,function(){f[this]=c[this]});e.find(l).trigger(f);c.stopPropagation();f.isDefaultPrevented()&&c.preventDefault()},m=[],t=function(c){var a=m.length;while(a--){var d=m[a],e=d.data(j);if(!e){m=m.splice(a,1)}else if(d.closest('html')[0]){q(e)}}if(!m.length){b(window).unbind('resize',t)}};b.fn[j]=function(e,i){if(e=='refresh'){i=i||{};this.each(function(){var c=b(this),a=b(this).data(j);if(i.reclone){s(a);a._0=1}a&&q(a)})}else{e=b.extend({},b.fn[j].defaults,e);this.filter(function(){return!b(this).data(j)}).each(function(c){var a=b(this),d={table:a,tbWrap:b(a.wrap(e.tbWrap||'<div class="tbody"/>').parent()),_2:e.cloneClass,_1:e.proxyEvents,_3:e.proxyEvProps.split(/\s*,\s*/),_0:1};if(e.wrap){d.wrap=wrapElm=b(e.wrap).data(j,d);d.tbWrap.wrap(wrapElm)}s(d);a.css('margin',0).data(j,d);q(d);m.push(a);b(window).bind('resize',t)})}return this};b.fn[j].defaults={proxyEvents:'click focusin focusout mouseup mousedown',proxyEvProps:'pageX pageY which',wrap:'<div class="scrollable" />',cloneClass:'screen-only'}})(jQuery);
