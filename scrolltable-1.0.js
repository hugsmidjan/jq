// encoding: utf-8
// $.fn.scrollTable 1.0  -- (c) 2010 HugsmiÃ°jan ehf.
(function(b,q){var j='scrollTable',r=function(f){var k=f.table,n=f._0&&(f.tbWrap.width()-k.outerWidth()),g=k.find('>tbody>tr:first>*').css('width',''),o=k.find('>thead,>tfoot').show(),s=[],p=[];g.each(function(c){var a=b(this);p[c]=a.outerWidth();s[c]=a.width()}).each(function(c){var a=p[c]-s[c];b(this).width(p[c]-a)});o.css('display','');f.clones.find('>*>tr').each(function(){var h=0,l=b(this).children();l.each(function(c){var a=b(this),e=a.data('padWidth'),d=(parseInt(a.attr('colspan'),10)||1),i=0;if(e==q){e=a.outerWidth()-a.width();a.data('padWidth',e)}while(d--){i+=p[h++]}a.width(i-e)});if(f._0){l.last().css('padding-right',function(c,a){return parseInt(a,10)+n})}});f._0=q},t=function(g){var o=g.table;g.clones&&g.clones.remove();g.clones=o.children('thead, tfoot').map(function(){var h=b(this),l=this.tagName.toLowerCase(),f=h.clone().data(j+'-org',h),k=b(o[0].cloneNode(false));g._1&&f.bind(g._1,g,v);k.attr('summary','Skip this table - it\'s for layout purposes only').append(h.is('thead')?h.prevAll('caption').clone():q).append(f).addClass(l+' '+(g._2))['insert'+(l=='thead'?'Before':'After')](g.tbWrap);var n=k.find('*').andSelf();n.filter('[id]').each(function(){var e=this.id,d=b.aquireId(e),i=b(this).attr('id',d);b.each({'input, select, textarea':'label[for','area':'img[usemap'},function(c,a){if(i.is(c)){k.find(a+'="'+e+'"]').attr(a.split('[')[1],d)}})});if(g._3){b.each(g._1.split(/\s+/),function(c,a){n.removeAttr('on'+a)})}return k[0]})},v=function(c){var a=this,e=c.data,d=b(a).data(j+'-org'),i=[],h=c.target;while(h!=a){i.unshift(h.tagName.toLowerCase()+':nth-child('+(b(h).index()+1)+')');h=h.parentNode}var l='>'+i.join('>'),f=b.Event(c.type);b.each(e._4,function(){f[this]=c[this]});d.find(l).trigger(f);c.stopPropagation();f.isDefaultPrevented()&&c.preventDefault()},m=[],u=function(c){var a=m.length;while(a--){var e=m[a],d=e.data(j);if(!d){m=m.splice(a,1)}else if(e.closest('html')[0]){r(d)}}if(!m.length){b(window).unbind('resize',u)}};b.fn[j]=function(d,i){if(d=='refresh'){i=i||{};this.each(function(){var c=b(this),a=b(this).data(j);if(i.reclone){t(a);a._0=1}a&&r(a)})}else{d=b.extend({},b.fn[j].defaults,d);this.filter(function(){return!b(this).data(j)}).each(function(c){var a=b(this),e={table:a,tbWrap:b(a.wrap(d.tbWrap||'<div class="tbody"/>').parent()),_2:d.cloneClass,_1:d.proxyEvents,_4:d.proxyEvProps.split(/\s*,\s*/),_3:d.hasEvAttrs,_0:1};if(d.wrap){e.wrap=wrapElm=b(d.wrap).data(j,e);e.tbWrap.wrap(wrapElm)}t(e);a.css('margin',0).data(j,e);r(e);m.push(a);b(window).bind('resize',u)})}return this};b.fn[j].defaults={proxyEvents:'click focusin focusout mouseup mousedown',proxyEvProps:'pageX pageY which',wrap:'<div class="scrollable" />',cloneClass:'screen-only'}})(jQuery);
