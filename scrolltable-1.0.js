// encoding: utf-8
// $.fn.scrollTable 1.0  -- (c) 2010 HugsmiÃ°jan ehf.
(function(b,q){var i='scrollTable',p=function(f){var k=f.table,g=f._0&&(f.tbWrap.width()-k.outerWidth()),n=k.find('>tbody>tr:first>*').css('width',''),u=k.find('>thead,>tfoot').show(),r=[],o=[];n.each(function(c){var a=b(this);o[c]=a.outerWidth();r[c]=a.width()}).each(function(c){var a=o[c]-r[c];b(this).width(o[c]-a)});u.css('display','');f.clones.find('>*>tr').each(function(){var j=0,l=b(this).children();l.each(function(c){var a=b(this),d=a.data('padWidth'),e=(parseInt(a.attr('colspan'),10)||1),h=0;if(d==q){d=a.outerWidth()-a.width();a.data('padWidth',d)}while(e--){h+=o[j++]}a.width(h-d)});if(f._0){l.last().css('padding-right',function(c,a){return parseInt(a,10)+g})}});f._0=q},s=function(g){var n=g.table;g.clones&&g.clones.remove();g.clones=n.children('thead, tfoot').map(function(){var j=b(this),l=this.tagName.toLowerCase(),f=j.clone().data(i+'-org',j),k=b(n[0].cloneNode(false));g._1&&f.bind(g._1,g,v);k.attr('summary','Skip this table - it\'s for layout purposes only').append(f).addClass(l+' '+(g._2))['insert'+(l=='thead'?'Before':'After')](g.tbWrap).find('*').andSelf().filter('[id]').each(function(){var d=this.id,e=b.aquireId(d),h=b(this).attr('id',e);b.each({'input, select, textarea':'label[for','area':'img[usemap'},function(c,a){if(h.is(c)){k.find(a+'="'+d+'"]').attr(a.split('[')[1],e)}})});return k[0]})},v=function(c){var a=this,d=c.data,e=b(a).data(i+'-org'),h=[],j=c.target;while(j!=a){h.unshift(j.tagName.toLowerCase()+':nth-child('+(b(j).index()+1)+')');j=j.parentNode}var l='>'+h.join('>'),f=b.Event(c.type);b.each(d._3,function(){f[this]=c[this]});e.find(l).trigger(f);c.stopPropagation();f.isDefaultPrevented()&&c.preventDefault()},m=[],t=function(c){var a=m.length;while(a--){var d=m[a],e=d.data(i);if(!e){m=m.splice(a,1)}else if(d.closest('html')[0]){p(e)}}if(!m.length){b(window).unbind('resize',t)}};b.fn[i]=function(e,h){if(e=='refresh'){h=h||{};this.each(function(){var c=b(this),a=b(this).data(i);if(h.reclone){s(a);a._0=1}a&&p(a)})}else{e=b.extend({},b.fn[i].defaults,e);this.filter(function(){return!b(this).data(i)}).each(function(c){var a=b(this),d={table:a,tbWrap:b(a.wrap(e.tbWrap||'<div class="tbody"/>').parent()),_2:e.cloneClass,_1:e.proxyEvents,_3:e.proxyEvProps.split(/\s*,\s*/),_0:1};if(e.wrap){d.wrap=wrapElm=b(e.wrap).data(i,d);d.tbWrap.wrap(wrapElm)}s(d);a.css('margin',0).data(i,d);p(d);m.push(a);b(window).bind('resize',t)})}return this};b.fn[i].defaults={proxyEvents:'click focusin focusout mouseup mousedown',proxyEvProps:'pageX pageY which',wrap:'<div class="scrollable" />',cloneClass:'screen-only'}})(jQuery);
