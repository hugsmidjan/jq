// $.fn.scrollTable 1.0  -- (c) 2010 HugsmiÃ°jan ehf.
(function(c,q){var i='scrollTable',r=function(g){var j=g.table,k=g._0&&Math.max(0,g.tbWrap.width()-j.outerWidth()),p=j.find('>tbody>tr:first>*').css('width',''),e=j.find('>thead,>tfoot').show(),n=[],o=[],s=0;p.each(function(a){var b=c(this);o[a]=b.outerWidth();n[a]=b.width();s+=o[a]}).each(function(a){var b=o[a]-n[a];c(this).width(o[a]-b)});e.css('display','');g.clones.width(s);g.clones.find('>*>tr').each(function(){var l=0,f=c(this).children();f.each(function(){var a=c(this),b=a.data('padWidth'),d=(parseInt(a.attr('colspan'),10)||1),h=0;if(b===q){b=a.outerWidth()-a.width();a.data('padWidth',b)}while(d--){h+=o[l++]}a.width(h-b)});if(g._0){f.last().css('padding-right',function(a,b){return parseInt(b,10)+k})}});g._0=q},t=function(e){var n=e.table;e.clones&&e.clones.remove();e.clones=n.children('thead, tfoot').map(function(){var f=c(this),g=this.tagName.toLowerCase(),j=f.clone().data(i+'-org',f),k=c(n[0].cloneNode(false));e._1&&j.bind(e._1,e,v);k.attr('summary','Skip this table - it\'s for layout purposes only').append(f.is('thead')?f.prevAll('caption').clone():q).append(j).addClass(g+' '+(e._2))['insert'+(g==='thead'?'Before':'After')](e.tbWrap);var p=k.find('*').add(k);p.filter('[id]').each(function(){var d=this.id,h=d+(Math.random()+'').substr(2),l=c(this).attr('id',h);c.each({'input, select, textarea':'label[for','area':'img[usemap'},function(a,b){if(l.is(a)){k.find(b+'="'+d+'"]').attr(b.split('[')[1],h)}})});if(e._3){c.each(e._1.split(/\s+/),function(a,b){p.removeAttr('on'+b)})}return k[0]})},v=function(a){var b=this,d=a.data,h=c(b).data(i+'-org'),l=[],f=a.target;while(f!==b){l.unshift(f.tagName.toLowerCase()+':nth-child('+(c(f).index()+1)+')');f=f.parentNode}var g='>'+l.join('>'),j=c.Event(a.type);c.each(d._4,function(){j[this]=a[this]});h.find(g).trigger(j);a.stopPropagation();j.isDefaultPrevented()&&a.preventDefault()},m=[],u=function(){var a=m.length;while(a--){var b=m[a],d=b.data(i);if(!d){m=m.splice(a,1)}else if(b.is('html *')){r(d)}}if(!m.length){c(window).unbind('resize',u)}};c.fn[i]=function(d,h){if(d==='refresh'){h=h||{};this.each(function(a){if(a=c(this).data(i)){if(h.reclone){t(a);a._0=1}r(a)}})}else{d=c.extend({},c.fn[i].defaults,d);this.filter(function(){return!c(this).data(i)}).each(function(){var a=c(this),b={table:a,tbWrap:c(a.wrap(d.tbWrap).parent()),_2:d.cloneClass,_1:d.proxyEvents,_4:d.proxyEvProps.split(/\s*,\s*/),_3:d.hasEvAttrs,_0:1};if(d.wrap){b.wrap=c(d.wrap).data(i,b);b.tbWrap.wrap(b.wrap)}t(b);a.css('margin',0).data(i,b);r(b);m.push(a);c(window).bind('resize',u)})}return this};c.fn[i].defaults={proxyEvents:'click focusin focusout mouseup mousedown',proxyEvProps:'pageX pageY which',wrap:'<div class="scrollable" />',tbWrap:'<div class="tbody"/>',cloneClass:'screen-only'}})(jQuery);
