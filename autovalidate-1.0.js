(function($){var u='tmp_'+(new Date()).getTime();var x=0;var y={lang:'en',maxLabelLength:35,errorAction:'focus',focusElmClass:'stream',submittedClass:'issubmitted',validateEachField:'',errorMsgType:'alertonly',inlineErrorClass:'errmsg',nextErrorLinkClass:'nexterror',customReqCheck:{},reqClassPattern:'req',reqErrorClass:'reqerror',typeErrorClass:'typeerror',defangReset:true,defangEnter:'auto',emulateTab:false,maxLengthTab:true};$.extend({av:{lang:{en:{bullet:' • ',errorReqMsg:'Please fill out these fields:\n\n',errorTypeMsg:'These fields contain invalid input:\n\n',inlineMsgPrefix:'Error:',inlineReqMsg:'This field is required ',inlineTypeMsg:'This field contains an invalid value ',inlineNextError:'Next error',resetAlert:'Note: You are about to reset all values in the form...'}},id:function(a){a=$(a);var b=a.attr('id');return(b)?b:a.attr('id',u+'_'+(x++)).attr('id')},cleanLabelString:function(t,a){if(!t){return''}a=a||35;t=t.replace(/\s\s+/g,' ').replace(/ - /g,', ').replace(/\[/g,'(').replace(/\]/g,')').replace(/\([^)]+\)/g,'').replace(/[\s*:#]+$/,'').replace(/^[\s*#]+/,'');if(t.length>(a+2)){t=t.substr(0,(a-2)).replace(/[.,:;\s]+$/,'')+'...'}return t},getLabel:function(a,b,c){var d=a.find(':input:first');var e=d.data('av-labeltext');if(!e){e=$.av.cleanLabelString(d.attr('title'),c.maxLabelLength);var f=d.attr('id');if(!e&&f){var l=d.parents('form').find('label[for='+f+']').text()||d.parent('label').text()||a.find('label').eq(0).text();e=$.av.cleanLabelString(l,c.maxLabelLength)}var g=a.is('fieldset:has(input[name='+d.attr('name')+']:eq(1))');if(g){var h=a.find(':header, legend, p').eq(0).text();e=(h)?$.av.cleanLabelString(h,c.maxLabelLength):e}if(!e){e=d.attr('name')}var i=b.find('fieldset:has(#'+$.av.id(a)+'):last').children(':header:first-child, legend:first-child, p:first-child');if(i.length){e=e+' ['+$.av.cleanLabelString(i.text(),c.maxLabelLength)+']'}$(d).data('av-labeltext',e)}return e},getText:function(a,b){return $.av.getError(a,b)||$.av.getError(a,'en')||''},getError:function(a,b){return($.av.lang[b]&&$.av.lang[b][a])||''},config:function(a,b){var c=$(a);var d=c.is('form')?c:$(c.attr('form')||c.parent('form').get(0));if(b){d.data('av-config',b)}else{b=d.data('av-config');if(!b){b=$.extend({},y);d.data('av-config',b)}}return b},addInlineLabels:function(d){var e=$.av.config(d[0]);$.each(d,function(i){var a=$(this);var b=a.attr('lang')||a.parents('[lang]').attr('lang');a.attr('lang',b);var c=$.av.getText('inlineReqMsg',b);if(a.is('.'+e.typeErrorClass)){c=a.data('av-error')||$.av.getText('inlineTypeMsg',b)}a.prepend('<strong class="'+e.inlineErrorClass+'">'+c+'</strong>');if(i<d.length-1){a.append('<a href="#'+$.av.id(d[i+1])+'" class="'+e.nextErrorLinkClass+'">'+$.av.getText('inlineNextError',b)+'</a>')}})},alertErrors:function(c,d){var e=$.av.config(c[0]);var f=$(c[0]).attr('lang')||$(c[0]).parents('[lang]').attr('lang');$(c[0]).attr('lang',f);var g=[];var h=[];var j='';$.each(c,function(i){var a=$(this);var b=$.av.getLabel(a,d,e);if($(this).is('.'+e.typeErrorClass)){h.push(b)}else{g.push(b)}});var k=$.av.getText('bullet',f);if(g.length){j+=$.av.getText('errorReqMsg',f)+k+g.join('\n'+k)}if(h.length){j+='\n\n';j+=$.av.getText('errorTypeMsg',f)+k+h.join('\n'+k)}alert($.trim(j))},focusNext:function(e){var f=$(':input').get();f=f.sort(function(a,b){var c=(a.tabIndex>0)?a.tabIndex:99999;var d=(b.tabIndex>0)?b.tabIndex:99999;return((c<d)*-1)+((c>d)*1)});var n=$.inArray(e,f);while(f[++n]&&f[n].tabIndex==-1){}var g=$(f[n]||f[0]);setTimeout(function(){g.focus()},1);return g}}});$.extend($.av,{type:{'fi_btn':function(v,w){return true},'fi_txt':function(v,w){return v!==''},'fi_sel':function(v,w){return v!==''},'fi_chk':function(v,w){var a=$(this);return a.parents('form').find('[name='+a.attr('name')+']').is(':checked')},'fi_rdo':function(v,w){var a=$(this);return a.parents('form').find('[name='+a.attr('name')+']').is(':checked')},'fi_bdy':function(v,w){return v!==''},'fi_file':function(v,w){return v!==''}}});$.fn.extend({defangReset:function(){return this.each(function(){$(this).click(function(e){var a=$(this);var b=a.attr('lang')||a.parents('[lang]').attr('lang')||'en';a.attr('lang',b);if(confirm($.av.getText('resetAlert',b))){if(a.attr('type')!=="reset"){var c=a.parents('form').get(0);if(c){c.reset()}}return true}return false})})},defangEnter:function(){return this.each(function(){$(this).keydown(function(e){var a=e.target;if(e.keyCode==13&&a.tagName==='INPUT'&&/^(button|reset|submit)$/i.test(a.type)){return false}return true})});return this},autoValidate:function(h){return this.each(function(){var b=$(this);var d=b.is('form')?b:$(this.form||b.parent('form').get(0));var g=$.extend({},y,h);$.av.config(this,g);if(g.defangReset){d.find(':reset').defangReset(g)}if(!g.emulateTab&&g.defangEnter===true||g.defangEnter==='true'||(g.defangEnter==='auto'&&d.attr('method')=='post'||d.is(':has(:submit:eq(1))'))){d.defangEnter()}if(g.emulateTab){d.keydown(function(e){if(e.keyCode==13&&$(e.target).is(':input:not(:button):not(:reset):not(:submit):not(textarea)')){$.av.focusNext(e.target);return false}})}if(g.maxLengthTab){d.keyup(function(e){var t=$(e.target);var w=e.which;if((w>0&&w!=8&&w!=9&&w!=13&&w!=16&&w!=17)&&t.attr('maxlength')==t.val().length){$.av.focusNext(e.target)}})}if(/blur|change/.test(g.validateEachField)){}d.submit(function(e){var f=$(this);var c=$.av.config(this);var a=f.isValid();if(a){f.addClass(c.submittedClass)}return a})})},isValid:function(p){var q=[];var r='';p=(p||p==null)?true:false;var s=false;this.each(function(){var k=$(this);var l=[];var n=true;conf=$.av.config(this);s=s||/both|alertonly/.test(conf.errorMsgType);r=r||'strong.'+conf.inlineErrorClass+', a.'+conf.nextErrorLinkClass;k.find(r).remove();var o=!k.is(':input')?k.find(':input'):k;o.each(function(){var a=$(this);a.removeData('av-malformed');var b=(this.type=='checkbox')?{'fi_chk':$.av.type['fi_chk']}:{'fi_txt':$.av.type['fi_txt']};var d=a.parents('[class~=fi_]');var e=d.attr('lang')||d.parents('[lang]').attr('lang');var f=d.hasClass(conf.reqClassPattern)||a.hasClass(conf.reqClassPattern);var g=$.trim(a.val());d.removeClass(conf.reqErrorClass);d.removeClass(conf.typeErrorClass);if(d.length!==0){var c,cls=$.trim(d.attr('class')).split(' ');while(c=cls.pop()){if(/^fi_/.test(c)&&$.isFunction($.av.type[c])){b[c]=$.av.type[c]}}}var h=a.attr('name');var i=conf.customReqCheck&&conf.customReqCheck[h];if(i&&$.isFunction(i)){f=i.call(this,g,d.get(0)||this,e)}else if(i&&typeof(i)==='string'){var m=/^(!)?(.*)$/.exec(i);var t=$(':input[name='+m[2]+']',this.form);if(t.length&&('checkbox'==t.attr('type')||'radio'==t.attr('type'))){f=!m[1]^!t.is(':checked')}else if(t.length){f=!m[1]^(t.val()=='')}}if(conf.customTypeCheck&&$.isFunction(conf.customTypeCheck[h])){b[h]=conf.customTypeCheck[h]}for(var v in b){d.attr('lang',e);var j=b[v].call(this,g,d.get(0)||this,e);if(j!==true){n=false;if(typeof(j)==='string'){l.push(d.get(0));d.data('av-error',j);d.removeClass(conf.reqErrorClass);d.addClass(conf.typeErrorClass)}else if(f){l.push(d.get(0));d.addClass(conf.reqErrorClass)}}}});if(p&&/both|inlineonly/.test(conf.errorMsgType)){$.av.addInlineLabels($.unique(l))}q=q.concat(l)});if(p&&s&&q.length){$.av.alertErrors($.unique(q),this)}return!q.length}})})(jQuery);jQuery.av.lang.is={bullet:' • ',errorReqMsg:'Það þarf að fylla út þessa liði:\n\n',errorTypeMsg:'Þessir liðir eru rangt útfylltir:\n\n',inlineMsgPrefix:'Villa:',inlineReqMsg:'Það þarf að fylla út þennan lið ',inlineTypeMsg:'Þessi liður er rangt út fylltur ',inlineNextError:'Næsta villa',resetAlert:'Ath: Þú ert í þann mund að afturkalla öll innslegin gildi...',fi_email:'Vinsamlega sláðu inn rétt netfang (dæmi: notandi@daemi.is)',fi_url:'Vinsamlega sláðu inn löggilda vefslóð (dæmi: http://www.example.is)',fi_year:'Vinsamlega sláðu inn rétt ártal (dæmi: 1998)'};(function($){$.extend($.av.lang.en,{fi_email:'Please provide a valid e-mail address (example: user@example.com)',fi_url:'Please provide a valid web address (example: http://www.example.is)',fi_year:'Please provide a valid four digit year (example: 1998)'});$.extend($.av.type,{fi_kt:function(v,w,a){var b=$.av.getError('fi_kt',a);if(v){var c=v.replace(/[\s\-]/g,'');$(this).val(c);var d=/010130[- ]?(2(12|20|39|47|55|63|71|98)|3(01|36)|4(33|92)|506|778)9/.test(c);if(!/^\d{9}[90]$/.test(c)||d){return b}var x=[3,2,7,6,5,4,3,2,1],_1=0,i=9;while(i--){_1+=(x[i]*c.charAt(i))}if(_1%11){return b}}return(v!='')},fi_email:function(v,w,a){if(v&&!/^[a-z0-9-._+]+@([a-z0-9-_]+\.)+[a-z0-9-_]{2,99}$/i.test(v)){return $.av.getError('fi_email',a)}return(v!='')},fi_url:function(v,w,a){if(v){var b=v.replace(/^[a-z]+:\/\/.+$/i,'');if(!/^[a-z]+:\/\/.+\..+$/.test(v)||/[\(\)\<\>\,\:\"\[\]\\]/.test(b)){return $.av.getError('fi_url',a)}return true}return false},fi_tel:function(v,w,a){if(v){return!v.replace(/(\s|[-+]|\d)/g,'')||''}return false},fi_postal_is:function(v,w,a){if(v){var b=$.av.postCodes&&$.av.postCodes.is;if(!b){return/^\d\d\d$/.test(v)||$.av.getError('fi_pnr',a)}else if(b[v]){if(this.nodeType){var c=$(this).siblings('span.unit');if(!c.length){c=$('<span class="unit"></span>');$(this).after(c)}c.html(b[v])}return true}return $.av.getError('fi_pnr',a)}return false},fi_pnrs:function(v,w,a){if(v){var b=v.replace(/(^[ ,;]+|[ ,;]+$)/g,'').split(/[ ,;]+/);var v,valid=false;for(var i=0;i<b.length;i++){v=$.av.type['fi_postal_is'](b[i],null,a);if(v!==true){return v}}return true}return false},fi_qty:function(v,w,a){$(this).val(v);return!v||/^\d+$/.test(v)||''},fi_num:function(v,w,a){var v=v.replace(/^-\s+/,'-').replace(/[,.]$/,'');$(this).val(v);return!v||(/\d/.test(v)&&/^-?\d*[.,]?\d*$/.test(v))||''},fi_year:function(v,w,a){if(v&&!/^(19|20)\d\d$/.test(v)){return $.av.getError('fi_year',a)}return(v!='')},fi_date:function(v,w,a){if(v){var b=$.av.getError('fi_year',a);if(window.datePicker&&datePicker.VERSION<2){var c=$.av.id(this),_0=datePicker.fields[c];if(_0){var e=datePicker.parseDate(c);if(!e){return b}else{var f=datePicker.printDateValue(e,_0.dateFormat,a).replace(/(^\s+|\s+$)/g,'');if(!_0.caseSensitive){v=v.toLowerCase();f=f.toLowerCase()}return(f!=v)||b}}}v=v.replace(/[ .-\/]+/g,'.').replace(/\.(\d\d)$/,'.20$1');return/^(3[01]|[12]?[0-9]|(0)?[1-9])\.(1[012]|(0)?[1-9])\.(19|20)?\d\d$/.test(v)||b}return(v!='')},fi_time:function(v,w,a){if(v){var b=$.av.getError('fi_time',a);if(/^([01]?\d|2[01234])(:([0-5]\d))?(:([0-5]\d))?\s*([ap]\.?m\.?)?$/i.test(v)){var h=parseInt(RegExp.$1,10),m=parseInt(RegExp.$3||'0',10),s=parseInt(RegExp.$5||'0',10),t=(RegExp.$6+'').replace('.','').toLowerCase();if(t=='pm'){h+=12}var c=(h*60*60)+(m*60)+(s*60);return(c<=86400)||b}else{return b}}return(v!='')},fi_ccnum:function(v,w,a){var b=$.av.getError('fi_ccnum',a);if(v){var c=v.replace(/[ -]/g,'');if(!/^\d{16}$/.test(c)){return b}var d=0;for(var i=0;i<c.length;i++){if((i%2)===0){var e=c.charAt(i)*2;d+=(e>9)?Math.floor((e/10)+(e%10)):e}else{d+=c.charAt(i)*1}}return((d%10)===0)||b}return(v!='')},fi_ccexp:function(v,w,a){if(v){v=v.replace(/(\d\d)\s*[ -\/]?\s*(\d\d)/,'$1/$2').replace(/\s+/g,'');return/^(0\d|1[012])\/(\d\d)$/.test(v)||$.av.getError('fi_ccexp',a)}return(v!='')}})})(jQuery);
