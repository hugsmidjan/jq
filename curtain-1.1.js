// encoding: utf-8
// $.fn.curtain 1.1  -- (c) 2010 Hugsmi√∞jan ehf.
(function(b){var e='curtain',l=b.browser.msie&&parseInt(b.browser.version,10)<7,p=!l?'min-':'',m=p+'width',n=p+'height',q='opacity',g=[],j=b(window),k,o=function(a){var d=!a?[this]:g,h=d.length,c,i=-1;while(h--){var f=b(d[h]);if(!f.data('is'+e)){b[e]('destroy',f)}else if(!a||(f[0].parentNode&&f.is(':visible'))){c=(i>-1)?c:Math.max(j.width(),k.innerWidth());i=(i>-1)?i:Math.max(j.height(),k.innerHeight());l&&f.css(m,0).css(n,0);f.css(m,c).css(n,i)}}};b[e]=function(a,d){if(a=='destroy'){var h=b.inArray(d,g);if(h>-1){b(d).remove();g.splice(h,1)}!g.length&&j.unbind('resize',o);return}if(a&&(a.tagName||a.jquery)){d=a;a={}}a=b.extend({className:e+'-overlay'},typeof(a)=='string'?{className:a}:(a&&typeof(a)=='boolean')?{bg:'#888',opacity:.5,z:99}:a||{});l&&(a.fixed=0);var c=b(d||'<div />').hide().addClass(a.className).css({position:a.fixed?'fixed':'absolute',top:0,left:0});if(!d||!d.parentNode){c.appendTo(document.body)}if(a.fixed){c.css(m,'100%').css(n,'100%')}else{g.push(c[0]);k=k||b('body');j.bind('resize',o);c.data('is'+e,!0).each(o)}if(a.bg||a[q]||a.z){c.css({background:a.bg,opacity:a[q],zIndex:a.z})}return c};b.fn[e]=function(a){return this.each(function(){b[e](a,this)})}})(jQuery);
