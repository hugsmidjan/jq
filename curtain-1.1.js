// $.fn.curtain 1.1  -- (c) 2010 HugsmiÃ°jan ehf.
(function(b){var e='curtain',m='opacity',f=[],j=b(window),k,l=function(a){var d=!a?[this]:f,g=d.length,c,h=-1;while(g--){var i=b(d[g]);if(!i.data('is'+e)){b[e]('destroy',i)}else if(!a||(i[0].parentNode&&i.is(':visible'))){c=(h>-1)?c:Math.max(j.width(),k.innerWidth());h=(h>-1)?h:Math.max(j.height(),k.innerHeight());i.css('width',c).css('height',h)}}};b[e]=function(a,d){if(a=='destroy'){var g=b.inArray(d,f);if(g>-1){b(d).remove();f.splice(g,1)}!f.length&&j.unbind('resize',l);return}if(a&&(a.tagName||a.jquery)){d=a;a={}}a=b.extend({className:e+'-overlay'},typeof(a)=='string'?{className:a}:(a&&typeof(a)=='boolean')?{bg:'#888',opacity:.5,z:99}:a||{});var c=b(d||'<div />').hide().addClass(a.className).css({position:a.fixed?'fixed':'absolute',top:0,left:0});if(!d||!d.parentNode){c.appendTo(document.body)}if(a.fixed){c.css('width','100%').css('height','100%')}else{f.push(c[0]);k=k||b('body');j.bind('resize',l);c.data('is'+e,!0).each(l)}if(a.bg||a[m]||a.z){c.css({background:a.bg,opacity:a[m],zIndex:a.z})}return c};b.fn[e]=function(a){return this.each(function(){b[e](a,this)})}})(jQuery);
