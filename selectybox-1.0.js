/* Selectybox 1.0  -- (c) 2012-2015 Hugsmiðjan ehf. - MIT/GPL   @preserve */
!function(){"use strict";var e,t=window,s=!!t.addEventListener,n=function(e,t){var n="add"===t,r=s?(n?"add":"remove")+"EventListener":(n?"at":"de")+"tachEvent",i=s?"":"on",o=e.select;o[r](i+"change",e._$refresh),o[r](i+"keyup",e._$refresh),o[r](i+"focus",e._$focus),o[r](i+"blur",e._$blur)},r=function(e,t,s){for(var n in t)e.style[n]=s?"":t[n]},i="templ getButton focusClass disabledClass emptyClass emptyVal text selectCSS".split(" "),o="_$refresh _$focus _$blur select container button".split(" "),l=function(t,s){var o=this,a=l.getWidget(t);if(a&&(a.destroy(),o=a),!(o instanceof l))return new l(t,s);if(s){for(var c,u=0;c=i[u++];)null!=s[c]&&(o[c]=s[c]);s=null}e=e||document.createElement("div"),e.innerHTML=o.templ.replace(/^[^<]+/,"");var f=o.container=e.firstChild;f.style.position="relative",o.button=o.getButton(),o.select=t,t.parentNode.insertBefore(f,t),f.insertBefore(t,o.button.nextSibling),t.style.opacity=1e-4,r(t,o.selectCSS),o._$refresh=function(){setTimeout(function(){o.refresh()},0)};var d=f.classList;o._$blur=function(){d.remove(o.focusClass)},o._$focus=function(){d.add(o.focusClass)};var p=!1;return o._$able=function(){t.disabled!==p&&(p=t.disabled,d[p?"add":"remove"](o.disabledClass))},n(o,"add"),o._isEmpty=!1,o.refresh(),t.$selectybox=o,a?o:void 0};l.prototype={templ:'<span class="selecty"><span class="selecty-button"/></span>',getButton:function(){return this.container.firstChild},focusClass:"focused",disabledClass:"disabled",emptyClass:"emptyvalue",emptyVal:"     ",text:function(e){return e},selectCSS:{position:"absolute",bottom:0,left:0,width:"100%",height:"100%",top:"auto",right:"auto",margin:0,padding:0,border:0},refresh:function(){this._$able(),this.val()},val:function(e){var t=this,s=t.select;if(null!=e){e+="";for(var n,r=0;n=s.options[r++];)if(n.value===e){n.selected=!0;break}}var i=s.options[s.selectedIndex],o=!i.value;o!==t._isEmpty&&(t._isEmpty=o,t.container.classList[o?"add":"remove"](t.emptyClass)),t.button.innerHTML=t.text(i.text.replace(/</g,"&lt;"))||t.emptyVal},disable:function(e){this.select.disabled=e!==!1,this._$able()},destroy:function(){var e=this,t=e.select,s=e.container,l=s.parentNode;l.insertBefore(t,s),l.removeChild(s),n(e,"remove"),t.style.opacity="",r(t,e.selectCSS,!0),t.$selectybox="";for(var a=i.concat(o),c=a.length;c--;)delete e[a[c]]}},l.jQueryPlugin=function(e){e.fn.selectybox=function(t,s){var n=this;if(n[0]){if("string"!=typeof t)return t=t||{},t.text=t.text||function(t){return e(this.container).toggleClass("selecty-empty",!e(this.select).val()),t},n.pushStack(n.filter("select").map(function(e,s){return l(s,t).container}));if("widget"===t)return l.getWidget(n[0]);/^(?:refresh|val|destroy)$/.test(t)&&n.each(function(){var e=l.getWidget(this);e&&e[t](s)})}return n}},l.getWidget=function(e){return e.$selectybox},"object"==typeof module&&module.exports?module.exports=l:t.Selectybox=l;var a=t.jQuery;a&&!a.fn.selectybox&&l.jQueryPlugin(a)}();
