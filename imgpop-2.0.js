// $.fn.imgPopper 2.0  -- (c) 2012 Hugsmiðjan ehf.
(function(e){e.imgPopper={version:2,defaultConfig:{fadeInSpeed:250,fadeOutSpeed:200},i18n:{en:{nextText:"Next",prevText:"Previous",closeText:"Close",imageText:"Image",ofTotalText:"of"},is:{nextText:"Næsta",prevText:"Fyrri",closeText:"Loka",imageText:"Mynd",ofTotalText:"af"}},imgTempl:'<div class="image">'+'<span class="img"><img src="%{img}" alt="%{alt}" /></span>'+'<strong class="title">%{title}</strong>'+'<div class="desc">%{alt}</div>'+"</div>",pagingTempl:'<div class="status">'+"<strong>%{imageText}</strong> "+'<span><b class="count">%{num}</b> %{ofTotalText} %{total}</span>'+"</div>"+'<ul class="stepper">'+'<li class="next"><a href="#">%{nextText}</a></li>'+'<li class="prev"><a href="#">%{prevText}</a></li>'+"</ul>",getImage:function(t){return e.inject(this.imgTempl,{img:t.attr("href"),alt:t.find("img").attr("alt")||"",title:t.find("img").attr("title")||""})}};e.fn.imgPopper=function(t){var i=e.imgPopper.i18n,n=this,a,l,g,s=e('<div class="paging" />'),p=e('<div class="imgwrap" />');i=i[e.lang()]||i.en;t=e.extend({},e.imgPopper.defaultConfig,i,t);n.on("click",function(i){l=e(this);a=n.index(l);s.empty().append(e.inject(e.imgPopper.pagingTempl,{imageText:t.imageText,ofTotalText:t.ofTotalText,nextText:t.nextText,prevText:t.prevText,total:n.length,num:a+1}));s.find("b").text(a+1);p.empty().append(e.imgPopper.getImage(n[a])).append(s);g=e.getModal({opener:l,content:p,fickle:{fadein:t.fadeInSpeed,fadeout:t.fadeOutSpeed}});g.addClass("imgpopper").fickle("open");s.delegate("li","click",function(t){var i=e(this);if(!i.is(".nav-end")){var l=i.is(".next")?1:-1;a=Math.min(Math.max(0,a+l),n.length-1);var g=!a,r=a===n.length-1;p.find(".image").replaceWith(e.imgPopper.getImage(n[a]));s.find("li.prev").toggleClass("nav-end",g);s.find("li.next").toggleClass("nav-end",r);s.find("b").text(a+1);if(!g){(new Image).src=n[a-1].href}if(!r){(new Image).src=n[a+1].href}}t.preventDefault()});i.preventDefault()});e(window).on("keyup",function(e){var t=e.which;t===27?g.fickle("close"):t===37?s.find(".prev").trigger("click"):t===39?s.find(".next").trigger("click"):null});return this}})(jQuery);
