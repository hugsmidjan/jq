/* $.imgPopper 2.0  -- (c) 2017 Hugsmiðjan ehf.  @preserve */
!function(s){s.imgPopper={version:2,defaultConfig:{modalClass:"imgpopper",fadeInSpeed:250,fadeOutSpeed:200,marginTop:void 0,preloadImages:!0,ficle:{}},i18n:{en:{nextText:"Next",prevText:"Previous",closeText:"Close",imageText:"Image",ofTotalText:"of"},is:{nextText:"Næsta",prevText:"Fyrri",closeText:"Loka",imageText:"Mynd",ofTotalText:"af"}},imgTempl:'<div class="image"><span class="img"><img src="%{img}" alt="%{alt}" /></span><strong class="title">%{title}</strong><div class="desc">%{alt}</div></div>',pagingTempl:'<div class="status"><strong>%{imageText}</strong> <span><b class="count">%{num}</b> %{ofTotalText} %{total}</span></div><ul class="stepper"><li class="next"><a href="#">%{nextText}</a></li><li class="prev"><a href="#">%{prevText}</a></li></ul>',getImage:function(e){return s.inject(this.imgTempl,{img:e.attr("href"),alt:e.find("img").attr("alt")||e.find("ins.image").data("alt")||"",title:e.find("img").attr("title")||e.find("ins.image").data("title")||""})}},s.fn.imgPopper=function(n){var a,t,e=s.imgPopper.i18n,l=this,g=s('<div class="paging" />'),p=s('<div class="imgwrap" />'),o=function(e,t,i){e.find("li.prev").toggleClass("nav-end",!t),e.find("li.next").toggleClass("nav-end",t===i-1),e.find("b").text(t+1)};return e=e[s.lang()]||e.en,n=s.extend({},s.imgPopper.defaultConfig,e,n),l.on("click",function(e){e.preventDefault(),t=s(this),a=l.index(t),g.empty().append(s.inject(s.imgPopper.pagingTempl,{imageText:n.imageText,ofTotalText:n.ofTotalText,nextText:n.nextText,prevText:n.prevText,total:l.length,num:a+1})),o(g,a,l.length),p.empty().append(s.imgPopper.getImage(l.eq(a))).append(g),s.getModal({opener:t,className:n.modalClass,marginTop:n.marginTop,content:p,fickle:s.extend({fadein:n.fadeInSpeed,fadeout:n.fadeOutSpeed,onClosed:function(){s(window).off("keyup.imgpopper"),s(this).remove()}},n.fickle)}).fickle("open"),s(window).on("keyup.imgpopper",function(e){37===e.which?g.find(".prev").trigger("click"):39===e.which&&g.find(".next").trigger("click")}),g.on("click","li",function(e){e.preventDefault();var t=s(this);if(!t.is(".nav-end")){var i=t.is(".next")?1:-1;a=Math.min(Math.max(0,a+i),l.length-1),p.find(".image").replaceWith(s.imgPopper.getImage(l.eq(a))),o(g,a,l.length),n.preloadImages&&(0!==a&&((new Image).src=l[a-1].href),a!==l.length-1&&((new Image).src=l[a+1].href))}})}),this}}(jQuery);
