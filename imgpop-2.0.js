// $.fn.imgPopper 2.0  -- (c) 2012 Hugsmiðjan ehf.
(function(a){a.imgPopper={version:2.0,defaultConfig:{fadeInSpeed:250,fadeOutSpeed:200,setContainerWidth:0},i18n:{en:{nextText:'Next',prevText:'Previous',closeText:'Close',imageText:'Image',ofTotalText:'of'},is:{nextText:'Næsta',prevText:'Fyrri',closeText:'Loka',imageText:'Mynd',ofTotalText:'af'}},imgTempl:'<div class="image"><span class="img"><img src="%{img}" alt="%{alt}" /></span><strong class="title">%{title}</strong><div class="desc">%{alt}</div></div>',pagingTempl:'<div class="status"><strong>%{imageText}</strong> <span><b>%{num}</b> %{ofTotalText} %{total}</span></div><ul class="stepper"><li class="next"><a href="#">%{nextText}</a></li><li class="prev"><a href="#">%{prevText}</a></li></ul>',getImage:function(f,d){var c=f.eq(d),h=new Image(),e=new Image();h.src=f.eq(d-1).attr('href');e.src=f.eq(d+1).attr('href');return a.inject(a.imgPopper.imgTempl,{img:c.attr('href'),alt:c.find('img').attr('alt')||'',title:c.find('img').attr('title')||''})}};a.fn.imgPopper=function(c){var h=a.imgPopper.i18n,e=this,b,i,j,g=a('<div class="paging" />'),k=a('<div class="imgwrap" />');h=h[a.lang()]||h.en;c=a.extend({},a.imgPopper.defaultConfig,h,c);e.on('click',function(d){i=a(this);b=e.index(i);g.empty().append(a.inject(a.imgPopper.pagingTempl,{imageText:c.imageText,ofTotalText:c.ofTotalText,nextText:c.nextText,prevText:c.prevText,total:e.length,num:(b+1)}));g.find('b').text(b+1);k.empty().append(a.imgPopper.getImage(e,b)).append(g);j=a.getModal({opener:i,content:k,fickle:{fadein:c.fadeInSpeed,fadeout:c.fadeOutSpeed}});j.addClass('imgpopper').fickle('open');g.delegate('li','click',function(f){if(a(this).is('.next')){b=b!=e.length-1?b+1:b}else{b=b!=0?b-1:b}k.find('.image').replaceWith(a.imgPopper.getImage(e,b));g.find('b').text(b+1);f.preventDefault()});d.preventDefault()});var l=function(f){var d=f.which;if(d==27){j.fickle('close')}if(d==37){g.find('.prev').trigger('click')}if(d==39){g.find('.next').trigger('click')}};a(window).on('keyup',l);return this}})(jQuery);
