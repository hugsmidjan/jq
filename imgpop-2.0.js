// $.fn.imgPopper 2.0  -- (c) 2012 Hugsmi√∞jan ehf.
(function(a){a.imgPopper={version:2,defaultConfig:{fadeInSpeed:250,fadeOutSpeed:200},i18n:{en:{nextText:"Next",prevText:"Previous",closeText:"Close",imageText:"Image",ofTotalText:"of"},is:{nextText:"N\u00e6sta",prevText:"Fyrri",closeText:"Loka",imageText:"Mynd",ofTotalText:"af"}},imgTempl:'<div class="image"><span class="img"><img src="%{img}" alt="%{alt}" /></span><strong class="title">%{title}</strong><div class="desc">%{alt}</div></div>',pagingTempl:'<div class="status"><strong>%{imageText}</strong> <span><b class="count">%{num}</b> %{ofTotalText} %{total}</span></div><ul class="stepper"><li class="next"><a href="#">%{nextText}</a></li><li class="prev"><a href="#">%{prevText}</a></li></ul>', getImage:function(b){return a.inject(this.imgTempl,{img:b.attr("href"),alt:b.find("img").attr("alt")||"",title:b.find("img").attr("title")||""})}};a.fn.imgPopper=function(b){var f=a.imgPopper.i18n,d=this,c,g,e=a('<div class="paging" />'),h=a('<div class="imgwrap" />'),l=function(a,k,b){a.find("li.prev").toggleClass("nav-end",!k);a.find("li.next").toggleClass("nav-end",k===b-1);a.find("b").text(k+1)},f=f[a.lang()]||f.en;b=a.extend({},a.imgPopper.defaultConfig,f,b);d.on("click",function(f){f.preventDefault(); g=a(this);c=d.index(g);e.empty().append(a.inject(a.imgPopper.pagingTempl,{imageText:b.imageText,ofTotalText:b.ofTotalText,nextText:b.nextText,prevText:b.prevText,total:d.length,num:c+1}));l(e,c,d.length);h.empty().append(a.imgPopper.getImage(d.eq(c))).append(e);a.getModal({opener:g,className:"imgpopper",content:h,fickle:{fadein:b.fadeInSpeed,fadeout:b.fadeOutSpeed,onClosed:function(){a(window).off("keyup.imgpopper");a(this).remove()}}}).fickle("open");a(window).on("keyup.imgpopper",function(a){37=== a.which?e.find(".prev").trigger("click"):39===a.which?e.find(".next").trigger("click"):null});e.on("click","li",function(b){b.preventDefault();b=a(this);b.is(".nav-end")||(b=b.is(".next")?1:-1,c=Math.min(Math.max(0,c+b),d.length-1),h.find(".image").replaceWith(a.imgPopper.getImage(d.eq(c))),l(e,c,d.length),0!==c&&((new Image).src=d[c-1].href),c!==d.length-1&&((new Image).src=d[c+1].href))})});return this}})(jQuery);
