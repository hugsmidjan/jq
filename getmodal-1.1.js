// $.getModal 1.1  -- (c) 2012 Hugsmi√∞jan ehf.
!function(e,o,l){l=e.getModal=function(n){n=e.extend({},l.defaults,n);var t=e(n.template);var a=e(n.opener||"html").closest("[lang]").attr("lang")||"en",s=t.find(n.closebtnSel),i=l.i18n;i=i[a.substr(0,2)]||i.en;s.attr("title",i.closeT||i.close).html(i.close||i.closeT);if(n.content){t.find(n.bodySel).append(n.content)}t.data("popclosebtn",s).data("popbody",t.find(n.bodySel)).addClass(n.className).on("click",function(o){var l=o.target;if(!n.modal&&(l===this||n.curtainSel&&l===e(this).find(n.curtainSel)[0])||e(l).closest(n.closebtnSel)[0]){e(this).fickle("close");return false}}).on("fickleopen",function(){e(this).appendTo(n.appendTo||"body");if(n.marginTop!==null){var l=n.marginTop;l=l===o?e(window).scrollTop():e.isFunction(l)?l.call(this):l;e(this).find(n.winSel).css("margin-top",l)}var t=!n.parentModal?[]:n.parentModal.charAt?e(n.opener||[]).closest(".modalpop"):e(n.parentModal);if(t[0]){setTimeout(function(){t.one("fickleclose.getmodal",function(e){e.preventDefault()}).on("mousemove.getmodal focusin.getmodal",function(){t.unbind(".getmodal")})},100)}}).fickle(e.extend({focusElm:n.winSel,onClosed:function(){t.remove()}},n.fickle,{opener:n.opener}));a=s=i=o;return t};l.defaults={template:'<div class="modalpop">'+'<span class="curtain"/>'+'<div class="popwin">'+'<div class="popbody"/>'+'<a class="closebtn" href="#"/>'+"</div>"+"</div>",parentModal:".modalpop",curtainSel:".curtain",winSel:".popwin",bodySel:".popbody",closebtnSel:".closebtn"};l.i18n={dk:{closeT:"Close popup",close:"Luk"},en:{closeT:"Close popup",close:"Close"},is:{closeT:"Loka glugga",close:"Loka"}}}(jQuery);
