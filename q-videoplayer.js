/* $.fn.videoList 1.0  -- (c) 2010 Hugsmi√∞jan ehf.  @preserve */
!function(e){var t=e('<div id="videobox" class="videobox box"><span class="videocontainer" /><h2/><div class="summary"/></div>'),a="file:"==(a=document.location.protocol)?"http:":a,i=function(i,o){var r,d,l,u=e(this),m=u.data("playvideo_cfg"),v=u.data("playvideo_data"),n=m.currentClass,s=v.videoHref,c=v.type,f=!1;if(m.setfragment&&!o&&e.setFrag(s.replace(/^(https?:)?\/\//i,"")),c.length){if(e("#video").remove(),e(t.data("videoopener")).removeClass(n),u.addClass(n),t.data("videoopener",u),"youtube"==c||"youtu"==c){var h="youtube"==c?s.match(/(?:embed\/|watch\/?\?v=)([^&?\/]+)/i):s.match(/\.be\/(.+)$/);(h=h&&h[1])&&(d="all"==m.autostart?d="&autoplay=1":"none"==m.autostart?d="":o?"":"&autoplay=1",r=a+"//www.youtube-nocookie.com/embed/"+h+"?rel=0&wmode=transparent"+d,l=m.vidHeight+30,f=!0)}else if("file"==c)d="all"==m.autostart?d="&autostart=true":"none"==m.autostart?d="":o?"":"&autostart=true",r="/bitar/common/media/mediaplayer.swf?file="+s+(m.defaultImg?"&image="+m.defaultImg:"")+d,l=m.vidHeight+20;else if("vimeo"==c)(p=(p=s.match(/\/([0-9a-z]{5,10})\/?(?:[#?]|$)/i))&&p[1])&&(d="all"==m.autostart?d="&autoplay=1":"none"==m.autostart?d="":o?"":"&autoplay=1",r=a+"//player.vimeo.com/video/"+p+"?title=1&amp;byline=0&amp;portrait=0"+d,l=m.vidHeight,f=!0);else if("facebook"==c){var p=s.match(/(?:\/v\/|[?&]v=)(\d{10,20})/);(p=p&&p[1])&&(r=a+"//www.facebook.com/v/"+p,l=m.vidHeight)}f?t.find(".videocontainer").html(e.inject('<iframe title="YouTube video player" width="%{vidwi}" height="%{vidhe}" src="%{vidurl}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>',{vidurl:r,vidwi:m.vidWidth,vidhe:l})):t.find(".videocontainer").html(e.inject('<object id="video" width="%{vidwi}" height="%{vidhe}"><param name="movie" value="%{vidurl}"></param><param name="wmode" value="transparent"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="%{vidurl}" type="application/x-shockwave-flash" wmode="transparent" allowscriptaccess="always" allowfullscreen="true" width="%{vidwi}" height="%{vidhe}"></embed></object>',{vidurl:r,vidwi:m.vidWidth,vidhe:l})),t.find("h2").text(u.find("h3 a").text()),t.find(".summary").html(u.find(".summary").html()),i.preventDefault()}};e.fn.videoList=function(a){var o=this;if(o.length){a=e.extend({vidWidth:684,vidHeight:414,currentClass:"current",autostart:"notfirst",youtubeImg:1,defaultImg:0,startOpen:1},a),t.insertBefore(o.eq(0)),o.find(".item").data("playvideo_cfg",a).bind("click",i).each(function(){var t=e(this),i=t.find("a").attr("href"),o=/\.youtube\.com/i.test(i)&&"youtube"||/\.(flv|mp4|m4v)(\?|$)/i.test(i)&&"file"||/vimeo\.com/i.test(i)&&"vimeo"||/youtu\.be/i.test(i)&&"youtu"||/facebook\.com/i.test(i)&&"facebook"||"",r={videoHref:i,type:o};if(t.data("playvideo_data",r),a.youtubeImg&&"youtube"==o&&(r.youtubeId=i.split("?")[1].match(/v=([^&]+)/)[1],a.thumbnails)){var d=Math.floor(3*Math.random()+1),l="large"==a.youtubeImg?"0":"default",u="http://i"+d+".ytimg.com/vi/"+r.youtubeId+"/"+l+".jpg";u&&t.find("img").attr("src",u)}});var r=e.getFrag(),d=r&&o.find('a[href$="'+r+'"]');a.startOpen&&e(d[0]||o.filter(":visible").find(".item")[0]).trigger("click",!0)}return o}}(jQuery);
