/* $.fn.videoList 1.0  -- (c) 2010 Hugsmi√∞jan ehf.  @preserve */
!function(e){var t=e('<div id="videobox" class="videobox box"><span class="videocontainer" /><h2/><div class="summary"/></div>'),a='<object id="video" width="%{vidwi}" height="%{vidhe}"><param name="movie" value="%{vidurl}"></param><param name="wmode" value="transparent"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="%{vidurl}" type="application/x-shockwave-flash" wmode="transparent" allowscriptaccess="always" allowfullscreen="true" width="%{vidwi}" height="%{vidhe}"></embed></object>',i='<iframe title="YouTube video player" width="%{vidwi}" height="%{vidhe}" src="%{vidurl}" frameborder="0" allowfullscreen></iframe>',o=document.location.protocol,o="file:"==o?"http:":o,r=function(r,d){var l,u,v,m=e(this),n=m.data("playvideo_cfg"),s=m.data("playvideo_data"),c=n.currentClass,f=s.videoHref,h=s.type,p=!1;if(n.setfragment&&!d&&e.setFrag(f.replace(/^(https?:)?\/\//i,"")),h.length){if(e("#video").remove(),e(t.data("videoopener")).removeClass(c),m.addClass(c),t.data("videoopener",m),"youtube"==h||"youtu"==h){var y="youtube"==h?f.match(/(?:embed\/|watch\/?\?v=)([^&?\/]+)/i):f.match(/\.be\/(.+)$/);y=y&&y[1],y&&(u="all"==n.autostart?u="&autoplay=1":"none"==n.autostart?u="":d?"":"&autoplay=1",l=o+"//www.youtube.com/embed/"+y+"?rel=0&wmode=transparent"+u,v=n.vidHeight+30,p=!0)}else if("file"==h){u="all"==n.autostart?u="&autostart=true":"none"==n.autostart?u="":d?"":"&autostart=true";var b=n.defaultImg?"&image="+n.defaultImg:"";l="/bitar/common/media/mediaplayer.swf?file="+f+b+u,v=n.vidHeight+20}else if("vimeo"==h){var g=f.match(/\/([0-9a-z]{5,10})\/?(?:[#?]|$)/i);g=g&&g[1],g&&(u="all"==n.autostart?u="&autoplay=1":"none"==n.autostart?u="":d?"":"&autoplay=1",l=o+"//player.vimeo.com/video/"+g+"?title=1&amp;byline=0&amp;portrait=0"+u,v=n.vidHeight,p=!0)}else if("facebook"==h){var g=f.match(/(?:\/v\/|[?&]v=)(\d{10,20})/);g=g&&g[1],g&&(l=o+"//www.facebook.com/v/"+g,v=n.vidHeight)}p?t.find(".videocontainer").html(e.inject(i,{vidurl:l,vidwi:n.vidWidth,vidhe:v})):t.find(".videocontainer").html(e.inject(a,{vidurl:l,vidwi:n.vidWidth,vidhe:v})),t.find("h2").text(m.find("h3 a").text()),t.find(".summary").html(m.find(".summary").html()),r.preventDefault()}};e.fn.videoList=function(a){var i=this;if(i.length){a=e.extend({vidWidth:684,vidHeight:414,currentClass:"current",autostart:"notfirst",youtubeImg:1,defaultImg:0,startOpen:1},a),t.insertBefore(i.eq(0)),i.find(".item").data("playvideo_cfg",a).bind("click",r).each(function(){var t=e(this),i=t.find("a").attr("href"),o=/\.youtube\.com/i.test(i)&&"youtube"||/\.(flv|mp4|m4v)(\?|$)/i.test(i)&&"file"||/vimeo\.com/i.test(i)&&"vimeo"||/youtu\.be/i.test(i)&&"youtu"||/facebook\.com/i.test(i)&&"facebook"||"",r={videoHref:i,type:o};if(t.data("playvideo_data",r),a.youtubeImg&&"youtube"==o&&(r.youtubeId=i.split("?")[1].match(/v=([^&]+)/)[1],a.thumbnails)){var d=Math.floor(3*Math.random()+1),l="large"==a.youtubeImg?"0":"default",u="http://i"+d+".ytimg.com/vi/"+r.youtubeId+"/"+l+".jpg";u&&t.find("img").attr("src",u)}});var o=e.getFrag(),d=o&&i.find('a[href$="'+o+'"]');a.startOpen&&e(d[0]||i.filter(":visible").find(".item")[0]).trigger("click",!0)}return i}}(jQuery);
