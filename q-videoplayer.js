// encoding: utf-8
// $.fn.videoList 1.0  -- (c) 2010 Hugsmi√∞jan ehf.
(function(c){var h=c('<div id="videobox" class="videobox box"><span class="videocontainer" /><h2/><div class="summary"/></div>'),p='<object id="video" width="%{vidwi}" height="%{vidhe}"><param name="movie" value="%{vidurl}"></param><param name="wmode" value="transparent"></param><param name="allowFullScreen" value="true"></param><param name="allowscriptaccess" value="always"></param><embed src="%{vidurl}" type="application/x-shockwave-flash" wmode="transparent" allowscriptaccess="always" allowfullscreen="true" width="%{vidwi}" height="%{vidhe}"></embed></object>',q='<iframe title="YouTube video player" width="%{vidwi}" height="%{vidhe}" src="%{vidurl}" frameborder="0" allowfullscreen></iframe>',j=document.location.protocol,j=j=='file:'?'http:':j,r=function(k,f){var g=c(this),a=g.data('playvideo_cfg'),n=g.data('playvideo_data'),o=a.currentClass,i=n.videoHref,e=n.type,d,b,l=false,m;a.setfragment&&!f&&c.setFrag(i.replace(/^(https?:)?\/\//i,''));c('#video').remove();c(h.data('videoopener')).removeClass(o);g.addClass(o);h.data('videoopener',g);if(e=='youtube'){var s=i.match(/(?:embed\/|watch\/?\?v=)([^&?\/]+)/i)[1];b=a.autostart=='all'?b='&autoplay=1':a.autostart=='none'?b='':f?'':'&autoplay=1';d=j+'//www.youtube.com/embed/'+s+'?rel=0'+b;m=a.vidHeight+30;l=true}else if(e=='file'){b=a.autostart=='all'?b='&autostart=true':a.autostart=='none'?b='':f?'':'&autostart=true';var t=a.defaultImg?'&image='+a.defaultImg:'';d='/bitar/common/media/mediaplayer.swf?file='+i+t+b;m=a.vidHeight+20}else if(e=='vimeo'){var u=i.match(/\/([0-9a-z]{5,10})\/?(?:[#?]|$)/i)[1];b=a.autostart=='all'?b='&autoplay=1':a.autostart=='none'?b='':f?'':'&autoplay=1';d=j+'//player.vimeo.com/video/'+u+'?title=1&amp;byline=0&amp;portrait=0&fullscreen=1'+b;m=a.vidHeight;l=true}if(l){h.find('.videocontainer').html(c.inject(q,{vidurl:d,vidwi:a.vidWidth,vidhe:m}))}else{h.find('.videocontainer').html(c.inject(p,{vidurl:d,vidwi:a.vidWidth,vidhe:m}))}h.find('h2').text(g.find('h3 a').text());h.find('.summary').text(g.find('.summary').text());k.preventDefault()};c.fn.videoList=function(e){var d=this;if(d.length){e=c.extend({vidWidth:684,vidHeight:414,currentClass:'current',autostart:'notfirst',youtubeImg:1,defaultImg:0,startOpen:1},e);h.insertBefore(d.eq(0));d.find('.item').data('playvideo_cfg',e).bind('click',r).each(function(){var k=c(this),f=k.find('a').attr('href'),g=(/\.youtube\.com/i.test(f)&&'youtube')||(/\.(flv|mp4|m4v)(\?|$)/i.test(f)&&'file')||(/vimeo\.com/i.test(f)&&'vimeo')||'',a={videoHref:f,type:g};k.data('playvideo_data',a);if(e.youtubeImg&&g=='youtube'){a.youtubeId=f.split('?')[1].match(/v=([^&]+)/)[1];if(e.thumbnails){var n=Math.floor(Math.random()*3+1),o=e.youtubeImg=='large'?'0':'default',i='http://i'+n+'.ytimg.com/vi/'+a.youtubeId+'/'+o+'.jpg';if(i){k.find('img').attr('src',i)}}}});var b=c.getFrag(),l=b&&d.find('a[href$="'+b+'"]');if(e.startOpen){c(l[0]||d.filter(':visible').find('.item')[0]).trigger('click',true)}};return d}})(jQuery);
