/* $.fn.fakeFile  -- (c) 2014 Hugsmiðjan ehf.  @preserve */
!function(o){o.fn.fakeFile=function(e){var t={cloneField:!1,textLength:40,useButtonElm:!1,removeText:"is"==o.lang()?"Fjarlægja skrá":"Remove file",nofileText:"is"==o.lang()?"Engin skrá valin":"No file selected",fileUploadedText:""},a=o.extend(t,e);return this.each(function(){!function(l,i){var n,f,e=l.find("input"),s=e.wrap('<div class="filewrap" />').parent();o(i.useButtonElm?'<button class="fakefile" type="button" />':'<a class="fakefile" href="#" />').on("click",function(e){e.preventDefault()}).appendTo(s);i.cloneField&&(n=e.attr("id").replace(/\d+$/,""),f=(f=e.attr("id").match(/(\d+)$/))?f[0]:0,o('<a class="remove" href="#" title="'+i.removeText+'">X</a>').appendTo(s).on("click",function(e){e.preventDefault(),o(this).parent()[o(this).closest(".filewrap").is(s)?"detach":"remove"]()})),s.on("change.file","input",function(){if(t=o(this).val().replace("C:\\fakepath\\","")){var e=t.toLowerCase().match(/[a-z0-9]+$/);e=e?e[0]:"default";var t=t.length>i.textLength?o.cropText(t,i.textLength-3):t,a=i.fileUploadedText?'<span class="upload-title">'+i.fileUploadedText+"</span>":"";o(this).next(".fakefile").html(a+'<span class="upload-filename">'+t+"</span>")[0].className="fakefile file_"+e}else o(this).next(".fakefile").html(i.nofileText)[0].className="fakefile file_empty";i.cloneField&&o(this).closest(".filewrap").is(":last-child")&&o(this).val()&&(f++,s.clone(!0,!0).appendTo(l).find("input").attr("id",n+f).attr("name",n+f).end().find(".fakefile").html(i.nofileText)[0].className="fakefile file_empty")}).find("input").trigger("change.file")}(o(this),a)})}}(jQuery);
