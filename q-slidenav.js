// $.fn.slideNav 1.0  -- (c) 2014 Hugsmi√∞jan ehf.
!function(a){a.fn.slideNav=function(){var e=a(window),n=this,l=n.find(".boxbody").wrap('<div class="bbclip" />'),i=a('<div class="goback hidden"><a href="#">Til baka</a></div>').prependTo(n),s=n.find(n.find(".current").length?".current":".parent:last"),t=0,d=0,c=1;return n.find("ul.level1").wrap('<div class="col lvl1" />'),s.length&&(t=parseInt(s.closest("ul").attr("class").match(/level(\d+)/)[1],0)-1,s.parents("ul").addClass("active")),l.find("li.branch").each(function(){var e=a(this).find("> ul"),n=parseInt(e.attr("class").match(/level(\d+)/)[1],0);e.prepend(a('<li class="title" />').addClass(a(this).is(".current")?"current":"").append(a(this).find("> a").clone())),a(this).append(a('<a href="#" class="expand">></a>').data("branch",e)),l.find(".lvl"+n).length||(l.append('<div class="col lvl'+n+'" />'),c++),e.appendTo(l.find(".lvl"+n))}),e.on("resize.slNav",a.throttleFn(function(){d=n.width(),l.find(".col").width(d),l.addClass("no-animation"),l.css({left:-(t*d),width:c*d}),setTimeout(function(){l.removeClass("no-animation")},10)},150)).trigger("resize.slNav"),l.on("click",".expand",function(e){e.preventDefault();var n=a(this).data("branch");t++,n.siblings().removeClass("active"),n.addClass("active"),l.css({left:-(t*d)}),i.addClass("visible")}),s.find("> .expand").trigger("click"),i.on("click",function(a){a.preventDefault(),t--,l.css({left:-(t*d)}),0===t&&i.removeClass("visible")}),t>0&&i.addClass("visible"),n}}(jQuery);
