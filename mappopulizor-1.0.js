/* $.mapPopulizor 1.0  -- (c) 2012 Hugsmi√∞jan ehf.  @preserve */
!function(e){var t=function(t,a){if(a){var i="string"==typeof t&&-1==t.indexOf("<")?e(t,a):e(t);return i.closest("html").length||i.appendTo(a),i}return e(t)};e.mapPopulizor={defaults:{mapElm:'<div class="map" />',listCont:'<ul class="itemlist" />',closeBtn:'<a href="#" title="Loka" class="closebtn">x</a>',activeClass:"maplist-active",mappoints:{},getXY:function(e){var t=this.getLinkUrl(e),a=t&&t.replace(/^.*\/(\d+)(\/|$|.html)/,"$1");return this.mappoints[a]||{x:0,y:0,f:1}},markerTempl:'<a href="#" class="marker"><span /><i><b>%{label}</b></i></a>',buildMarker:function(t){return e(e.inject(this.markerTempl,{label:this.getLabel(t)}))},itemTempl:'<li><a href="%{url}">%{label}</a></li>',buildItem:function(t){var a={url:this.getLinkUrl(t)||"#",label:this.getLabel(t)};return e(e.inject(this.itemTempl,a))},labelSelector:"h3",getLabel:function(t){return e.trim(e(t).find(this.labelSelector).text())},linkSelector:"h3 > a, span.more a",getLinkUrl:function(t){return e(t).find(this.linkSelector).attr("href")},itemselector:"div.item",markerActiveClass:"marker-active",liActiveClass:"marker-active",x_flip:1e3,markerFlipClass:"marker-flip",bubbleFlipClass:"bubble-flip",dotOffset:[0,0],fadeSpeed:[400,400]}},e.fn.mapPopulizor=function(a){return a=e.extend({},e.mapPopulizor.defaults,a),this.addClass(a.activeClass).each(function(){var i=e(this),s=t(a.mapElm,i),l=t(a.listCont,i);e(a.itemselector,i).hide().each(function(){var r=e(this),n=a.buildItem(r).appendTo(l),o=a.buildMarker(r),d=t(a.closeBtn),c=a.getXY(r);c&&(e([o[0],r.find("h3")[0],n.find("a")[0],d[0]]).bind("click",function(t){return r.is(":visible")?(r.stop().fadeOut(a.fadeSpeed[1],function(){e(this).css("opacity",""),n.removeClass(a.liActiveClass)}),o.removeClass(a.markerActiveClass)):(i.find("a.marker-active").trigger("click").trigger("mouseleave").blur(),r.stop().fadeIn(a.fadeSpeed[0],function(){e(this).css("opacity",""),o.addClass(a.markerActiveClass)}),n.addClass(a.liActiveClass)),!1}),c.f&&o.addClass("marker-false"),o.css({left:c.x+a.dotOffset[0],top:c.y+a.dotOffset[1]}).find("i").hide().end().bind("mouseenter mouseleave",function(t){e("i",this).stop()["mouseenter"==t.type?"fadeIn":"fadeOut"]("mouseenter"==t.type?a.fadeSpeed[0]:a.fadeSpeed[1],function(){8>parseInt((/MSIE ([\w.]+)/.exec(navigator.userAgent)||[])[1],10)&&("mouseenter"==t.type?e("body").addClass("hovering"):e("body").removeClass("hovering")),e(this).css("opacity","")})}),c.x>=a.x_flip&&(r.addClass(a.bubbleFlipClass),o.addClass(a.markerFlipClass)),r.css({left:c.x+a.dotOffset[0],top:c.y+a.dotOffset[1]}).hide().append(d),s.append(r),s.prepend(o))})}),this}}(jQuery);
