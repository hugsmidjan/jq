// encoding: utf-8
// $.fn.abcnavize 1.0  -- (c) 2009 Hugsmiðjan ehf.
(function(b){var l=b.fn.abcnavize=function(a){a=b.extend({menuTmpl:'<div class="abcnav"><span>%{title}</span> <b /></div>',listSel:'b',itmTmpl:'<a href="%{frag}">%{label}</a>',itmSel:'a',noFoundTmpl:'<tr class="nothingfound"><td colspan="%{colspan}"><strong>%{msg}</strong></td></tr>',rowSelector:'tbody tr',activeClass:'current',fragmPrefix:'index:',allBtn:!0,zebraize:!0},a);return this.each(function(){var j=b(this),f=j.find(a.rowSelector),k=k||l.texts[j.closest('[lang]').attr('lang')]||l.texts.en,g,p=function(h){var d=b(h.target).closest('a'),c=d.closest(a.itmSel);if(d[0]&&!c.is('.'+e)){var e=a.activeClass;i.find(a.itmSel+'.'+e).removeClass(e);c.addClass(e);var m=b.getFrag(d.attr('href'));h.type=='click'&&b.setFrag(m);var q=f.hide().filter(function(){return!m||b(this).data('abcnav-fragm')==m}).css('display','');if(q.length){g&&g.detach();if(a.zebraize){q.removeClass('even').filter(':odd').addClass('even')}}else{if(!g){g=b(a.noFoundTmpl.replace('%{msg}',k.noFoundMsg).replace('%{colspan}',f.eq(0).children().length))}g.insertBefore(f[0])}}return false},n={},i=b(a.menuTmpl.replace('%{title}',k.abcTitle)).bind('click',p),o=i.find(a.listSel);if(a.allBtn){b(a.itmTmpl.replace('%{frag}','#').replace('%{label}',k.abcAll)).appendTo(o)}f.each(function(){var h=b(this),d=b.trim(h.text()).charAt(0).toUpperCase(),c=a.fragmPrefix+d;h.data('abcnav-fragm',c);if(!n[c]){n[c]=1;var e=b(a.itmTmpl.replace('%{frag}','#'+b.encodeFrag(c)).replace('%{label}',d));o.append(' ',e)}});var r=b.getFrag()||(a.startOn&&a.fragmPrefix+a.startOn),s=n[r]?'[href$="#'+b.encodeFrag(r)+'"]':'';if(s){p.call(null,{target:i.find('a'+s)[0]})}else if(!!a.startHidden){f.hide()}i.insertBefore(j);o=undefined;j.data('abcnav',{menu:i,cfg:a})})};l.texts={en:{abcTitle:'Initial:',abcAll:'Show all',noFoundMsg:'No items match this criteria.'},is:{abcTitle:'Upphafsstafur:',abcAll:'Sýna alla',noFoundMsg:'Engar línur uppfylla þessi leitarskilyrði.'}}})(jQuery);
