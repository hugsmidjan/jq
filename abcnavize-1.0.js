// encoding: utf-8
// $.fn.abcnavize 1.0  -- (c) 2009 Hugsmiðjan ehf.
(function(b){var m=b.fn.abcnavize=function(a){a=b.extend({menuTmpl:'<div class="abcnav"><span>%{title}</span> <b /></div>',listSel:'b',itmTmpl:'<a href="%{frag}">%{label}</a>',itmSel:'a',noFoundTmpl:'<tr class="nothingfound"><td colspan="%{colspan}"><strong>%{msg}</strong></td></tr>',rowSelector:'tbody tr',activeClass:'current',fragmPrefix:'index:',allBtn:!0,zebraize:!0},a);return this.each(function(){var f=b(this),g=f.find(a.rowSelector),l=l||m.texts[f.closest('[lang]').attr('lang')]||m.texts.en,h,s=function(i){var c=b(i.target).closest('a'),d=c.closest(a.itmSel);if(c[0]&&!d.is('.'+e)){var e=a.activeClass;j.find(a.itmSel+'.'+e).removeClass(e);d.addClass(e);var k=b.getFrag(c.attr('href'));i.type=='click'&&b.setFrag(k);if(k==a.fragmPrefix+'all'){k=''}var n=g.hide().filter(function(){return!k||b(this).data('abcnav-fragm')==k}).css('display','');if(n.length){h&&h.detach();if(a.zebraize){n.removeClass('even').filter(':odd').addClass('even')}}else{if(!h){h=b(a.noFoundTmpl.replace('%{msg}',l.noFoundMsg).replace('%{colspan}',g.eq(0).children().length))}h.insertBefore(g[0])}var o=b.Event('abcnavfiltered');o.menuLink=c;o.visibleRows=n;f.trigger(o)}return false},p={},j=b(a.menuTmpl.replace('%{title}',l.abcTitle)).bind('click',s),q=j.find(a.listSel);if(a.allBtn){b(a.itmTmpl.replace('%{frag}','#'+(a.startHidden?a.fragmPrefix+'all':'')).replace('%{label}',l.abcAll)).appendTo(q)}g.each(function(){var i=b(this),c=b.trim(i.text()).charAt(0).toUpperCase(),d=a.fragmPrefix+c;i.data('abcnav-fragm',d);if(!p[d]){p[d]=1;var e=b(a.itmTmpl.replace('%{frag}','#'+b.encodeFrag(d)).replace('%{label}',c));q.append(' ',e)}});var r=b.getFrag()||(a.startOn&&a.fragmPrefix+a.startOn),t=(p[r]||r==a.fragmPrefix+'all')?'[href$="#'+b.encodeFrag(r)+'"]':'';if(t){s.call(null,{target:j.find('a'+t)[0]})}else if(!!a.startHidden){g.hide()}j.insertBefore(f);q=undefined;f.data('abcnav',{menu:j,cfg:a})})};m.texts={en:{abcTitle:'Initial:',abcAll:'Show all',noFoundMsg:'No items match this criteria.'},is:{abcTitle:'Upphafsstafur:',abcAll:'Sýna alla',noFoundMsg:'Engar línur uppfylla þessi leitarskilyrði.'}}})(jQuery);
