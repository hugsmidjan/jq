// encoding: utf-8
// $.fn.abcnavize 1.0  -- (c) 2009 Hugsmiðjan ehf.
(function(b){var l=b.fn.abcnavize=function(a){a=b.extend({menuTmpl:'<div class="abcnav"><span>%{title}</span> <b /></div>',listSel:'b',itmTmpl:'<a href="%{frag}">%{label}</a>',itmSel:'a',noFoundTmpl:'<tr class="nothingfound"><td colspan="%{colspan}"><strong>%{msg}</strong></td></tr>',rowSelector:'tbody tr',activeClass:'current',fragmPrefix:'index:',allBtn:!0,zebraize:!0},a);return this.each(function(){var j=b(this),e=j.find(a.rowSelector),k=k||l.texts[j.closest('[lang]').attr('lang')]||l.texts.en,f,p=function(g){var h=b(g.target).closest('a'),c=h.closest(a.itmSel),d=a.activeClass;if(!c.is('.'+d)){i.find(a.itmSel+'.'+d).removeClass(d);c.addClass(d);var m=b.getFrag(h.attr('href'));g.type=='click'&&b.setFrag(m);var q=e.hide().filter(function(){return!m||b(this).data('abcnav-fragm')==m}).css('display','');if(q.length){f&&f.detach();if(a.zebraize){q.removeClass('even').filter(':odd').addClass('even')}}else{if(!f){f=b(a.noFoundTmpl.replace('%{msg}',k.noFoundMsg).replace('%{colspan}',e.eq(0).children().length))}f.insertBefore(e[0])}}return false},n={},i=b(a.menuTmpl.replace('%{title}',k.abcTitle)).bind('click',p),o=i.find(a.listSel);if(a.allBtn){b(a.itmTmpl.replace('%{frag}','#').replace('%{label}',k.abcAll)).appendTo(o)}e.each(function(){var g=b(this),h=b.trim(g.text()).charAt(0).toUpperCase(),c=a.fragmPrefix+h;g.data('abcnav-fragm',c);if(!n[c]){n[c]=1;var d=b(a.itmTmpl.replace('%{frag}','#'+b.encodeFrag(c)).replace('%{label}',h));o.append(' ',d)}});var r=b.getFrag()||(a.startOn&&a.fragmPrefix+a.startOn),s=n[r]?'[href$="#'+b.encodeFrag(r)+'"]':'';if(s){p.call(null,{target:i.find('a'+s)[0]})}else if(!!a.startHidden){e.hide()}i.insertBefore(j);o=undefined;j.data('abcnav',{menu:i,cfg:a})})};l.texts={en:{abcTitle:'Initial:',abcAll:'Show all',noFoundMsg:'No items match this criteria.'},is:{abcTitle:'Upphafsstafur:',abcAll:'Sýna alla',noFoundMsg:'Engar línur uppfylla þessi leitarskilyrði.'}}})(jQuery);
