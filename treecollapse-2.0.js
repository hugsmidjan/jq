// $.fn.treeCollapse 2.0  -- (c) 2009 Hugsmiðjan ehf.
(function(b){b.fn.treeCollapse=function(a){a=b.extend({rootClass:'tree-active',branch:'li.branch',toggler:'> a',openClass:'open',closedClass:'closed',leaf:'li',parentClass:'parent',selectClass:'selected',doSelect:0,startOpen:'.parent, .selected, .open',togglerInt:'> a.expand',togglerHtml:'<a class="expand" href="#"></a>',togglerPlus:'+',togglerMinus:'-',doTogglers:0},a);var i={en:{plusTitle:'Show sub-items',minusTitle:'Hide sub-items'},is:{plusTitle:'Birta undirlínur',minusTitle:'Fela undirlínur'}},m=(this.closest('[lang]').attr('lang')||'en').substr(0,2),n=i[m]||i.en;i=m=undefined;var o=!a.branch;if(o){this.aquireId()}var j=a.branch,p=a.openClass,g=a.closedClass,q=a.parentClass,k=a.selectClass,r=a.togglerInt,s=a.togglerPlus,t=a.togglerMinus,u=n.plusTitle,v=n.minusTitle,l=a.doTogglers;this.addClass(a.rootClass).if_(a.doSelect).each(function(){var e=b(this),c=b(e).find(a.leaf+'.'+k).eq(0);b(e).bind('click',function(h){var d=b(h.target).closest(a.leaf);if(d[0]&&d[0]!==c[0]){var f=j||'#'+e.id;if(c.length){c.removeClass(k).parents(f).removeClass(q)}c=d;c.addClass(k).parents(f).addClass(q)}})}).end().each(function(){var e=this,c=j||'#'+e.id;b(e).bind('click',function(h){if(b(h.target).closest(c+' '+a.toggler)[0]){var d=b(h.target).closest(c),f=d.hasClass(g);b(this).trigger('Branch'+(f?'Open':'Close'),{branch:d[0]});d.toggleClasses(p,g).if_(l).find(r).attr('title',f?v:u).text(f?t:s);return false}})});var w=o?this:this.find(j);w.if_(l).prepend(b(a.togglerHtml).attr('title',u).text(s)).end().addClass(g).filter(a.startOpen).removeClass(g).addClass(p).if_(l).find(r).attr('title',v).text(t);return this}})(jQuery);
