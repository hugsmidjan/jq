// $.fn.listscroller 1.1  -- (c) 2009 Hugsmiðjan ehf.
!function(e,t,s){e.listscroller={version:1,defaultConfig:{item:"",windowSize:3,stepSize:1,startPos:0,hideClass:"overflow",topClass:"at-top",bottomClass:"at-bottom",wrap:"both",overflow:"visible",controls:"below",animation:"none",easing:"swing",speed:600,aspect:"auto",jumpPager:t,autoScrollDelay:0,setFocus:t,moveCallback:function(){},classPrefix:"listscroller",currentPageClass:"current",currentItemClass:"visible",cursorItemClass:"current",pagingTopClass:"paging paging-top",pagingBottomClass:"paging paging-bottom",pagingTemplate:'<div><ul class="stepper"/></div>',nextBtnTemplate:'<li class="next"><a href="#"/></li>',prevBtnTemplate:'<li class="prev"><a href="#"/></li>',jumpTemplate:'<li class="jump"/>',jumpLabelTemplate:"<strong/>",jumpWrapTemplate:"<span/>",jumpBtnTemplate:'<a href="#"/>',statusTempl:'<div class="status"/>',statusLabelTempl:"<strong/>",statusWrapTempl:"<span/>",statusCurrTempl:"<b/>",statusTotalTempl:"<i/>",inputPagerTempl:'<input type="text" value="" size="2"/>'},i18n:{en:{labelNext:"Next",labelPrev:"Previous",titleNext:"Page forward",titlePrev:"Page back",jumpLabel:"Pages:",statusLabel:"Page: ",ofTotalSeparator:" of ",statusLabelAfter:""},is:{labelNext:"Næsta",labelPrev:"Fyrri",titleNext:"Fletta áfram",titlePrev:"Fletta til baka",jumpLabel:"Síður:",statusLabel:"Síða: ",ofTotalSeparator:" af ",statusLabelAfter:""}},animate:{none:function(e,t){},carousel:function(e,t){var s,a=e.eq(0).closest("."+t.classPrefix+"-wrapper"),l=e.eq(e.length-1),i=e.length-t.stepSize,n=t.aspect==="horizontal",r=n?"scrollLeft":"scrollTop",o=n?"left":"top",p=n?"outerWidth":"outerHeight",u={};a.stop();s=e.eq(t.index).position();u[r]=s[o];if(t.wrap=="loop"&&t.lastIndex==0&&t.index==i){a[r](l.position()[o]+l[p]());a.animate(u,t.speed,t.easing)}else if(t.wrap=="loop"&&t.lastIndex==i&&t.index==0){u[r]=l.position()[o]+l[p]();a.animate(u,t.speed,t.easing,function(){a[r](0)})}else{a.animate(u,t.speed,t.easing)}},crossfade:function(t,s){t.each(function(t,a,l){a=t>=s.index&&t<s.index+s.windowSize;l=s.lastIndex==null||t>=s.lastIndex&&t<s.lastIndex+s.windowSize;if(!a&&s.lastIndex==null){e(this).stop().hide()}else if(a&&!l){e(this).stop().hide().fadeIn(s.speed)}else if(!a&&l){e(this).stop().show().css({opacity:1}).fadeOut(s.speed)}})},accordion:function(t,s){var a,l=s.aspect=="vertical"?"height":"width";t.each(function(t,i,n){i=t>=s.index&&t<s.index+s.windowSize;n=s.lastIndex==null||t>=s.lastIndex&&t<s.lastIndex+s.windowSize;a={};if(!i&&s.lastIndex==null){e(this).stop().hide()}else{a[l]=i&&!n?"show":!i&&n?"hide":undefined;a[l]&&e(this).stop().animate(a,s.speed,s.easing,function(){this.style[l]=""})}})}},wrap:{none:function(e,t,s){return Math.max(Math.min(e,l(t,s)),0)},start:function(e,t,s){var a=l(t,s);if(e<0){return s.index==0?a:0}if(e>a){return a}return e},end:function(e,t,s){var a=l(t,s);if(e<0){return 0}if(e>a){return s.index==a?0:a}return e},both:function(e,t,s){var a=l(t,s);if(e<0){return s.index==0?a:0}if(e>a){return s.index==a?0:a}return e},random:function(e,t,s){return Math.floor(Math.random()*t.length)},loop:function(e,t,s){return(t.length+e)%t.length}},aspectDefaults:{none:"vertical",carousel:"horizontal",crossfade:"horizontal",accordion:"vertical"}};function a(e){var t,a=e.eq(1),l=e.eq(0).offset(),i=a.offset();if(i&&a.is(":visible")){return Math.abs(i.top-l.top)<=Math.abs(i.left-l.left)?"horizontal":"vertical"}return s}function l(e,t){var s=t.overflow=="visible"?e.length-(e.length%t.stepSize||t.stepSize):e.length-t.windowSize;return s}function i(t,s,a){clearTimeout(t.scrollTimeout);a=a||{};var l=t.block;var i=t.list;t.lastIndex=t.index;t.index=e.listscroller.wrap[t.wrap||"none"](s,i,t);if(t.index!=t.lastIndex){i.addClass(t.hideClass).removeClass(t.cursorItemClass).removeClass(t.currentItemClass).slice(t.index,t.index+t.windowSize).addClass(t.currentItemClass).removeClass(t.hideClass).eq(0).addClass(t.cursorItemClass);if(e.isFunction(t.moveCallback)){t.moveCallback.call(l,i,t)}if(e.isFunction(t.animation)){t.animation.call(l,i,t)}else{e.listscroller.animate[t.animation||"none"].call(l,i,t)}if(!a._noFocus&&t.setFocus){setTimeout(function(){i.eq(t.index).setFocus()},t.speed||1)}l.removeClass(t.topClass).removeClass(t.bottomClass);if(t.index==0){l.addClass(t.topClass)}if(i.length-t.index<=t.windowSize){l.addClass(t.bottomClass)}if(!a._noFlash){l.addClass(t.classPrefix+"-changed");setTimeout(function(){l.removeClass(t.classPrefix+"-changed")},t.speed||1)}var n=Math.ceil(t.index/t.stepSize);if(t.jumps){t.jumps.removeClass(t.currentPageClass).eq(n).addClass(t.currentPageClass)}var r=t.itemStatusPager?t.index:n;t.inputPager&&t.inputPager.val(n+1);t.status&&t.status.text(r+1);if(t.status&&t.itemStatusPager&&t.windowSize>1){var o=r+t.windowSize;o=o>i.length?i.length:o;t.status.append("-"+o)}if(t.autoScrollDelay){l.queue(function(){l.trigger("afterMove").dequeue()})}}}function n(e){var t=e.data;i(t,t.index-t.stepSize);return s}function r(e){var t=e.data;i(t,t.index+t.stepSize);return s}function o(t){var a=t.data,l=parseInt(e(this).text(),10)-1||0;i(a,l*a.stepSize);return s}function p(t){var a=t.data,n=Math.max(0,parseInt("0"+e(this).val(),10)-1)||0,r=Math.min(n*a.stepSize,l(a.list,a));i(a,r);return s}function u(t){var s=e(t.nextBtnTemplate),a=e(t.prevBtnTemplate),l,i;e(s.find("a")[0]||s).bind("click",t,r).attr("title",t.titleNext).text(t.labelNext);e(a.find("a")[0]||a).bind("click",t,n).attr("title",t.titlePrev).text(t.labelPrev);if(t.paging){var u=Math.ceil(t.index/t.stepSize),c=Math.ceil(t.list.length/t.stepSize),d=t.itemStatusPager?t.list.length:c;if(t.statusPager||t.inputPager){i=e(t.statusTempl);e(t.statusLabelTempl).html(t.statusLabel).appendTo(i);var f=e(t.statusWrapTempl).appendTo(i);e(t.statusTotalTempl).html(t.ofTotalSeparator+d+t.statusLabelAfter).appendTo(f);if(t.inputPager){t.inputPager=e(t.inputPagerTempl).prependTo(f).val(u+1).bind("change",t,p)}else{t.status=e(t.statusCurrTempl).prependTo(f)}}if(t.jumpPager){var m=[];l=e(t.jumpTemplate);if(t.jumpLabelTemplate){e(t.jumpLabelTemplate).text(t.jumpLabel).appendTo(l)}for(var v=0;v<c;v++){var g=e(t.jumpBtnTemplate),h=e(g.find("a")[0]||g).text(v+1).attr("title",t.statusLabel+(v+1)).addClass("p"+(v+1)).bind("click",t,o);if(t.index==v){h.addClass(t.currentPageClass)}m.push(h[0])}t.jumps=e(m);e(t.jumpWrapTemplate||[]).append(t.jumps).appendTo(l)}}return e(t.pagingTemplate).deepest().append(s,a,l).end().prepend(i)}function c(s,l,n){var r,o,p;var c=l.data("listscrollerCfg");if(c){l.removeData("listscrollerCfg");o=c.list.parent();p=o.parent();if(s.destroy){o.filter("div").zap();p.zap();o=p=undefined}clearTimeout(c.scrollTimeout);var d=l[0].style.display||"";l.hide().removeClass(c.classPrefix+"-active").removeClass(c.topClass).removeClass(c.bottomClass).removeClass("block-mouseover").unbind(".lscr").data("lstscr_pagingElms").remove();l.removeData("lstscr_pagingElms");c.list.removeClass(c.hideClass).removeClass(c.cursorItemClass).removeClass(c.currentItemClass).css({display:""});c.flipover&&c.flipover.remove();o&&o.removeClass(c.classPrefix+"-clip").css("position","");p&&p.scroll(0,0).removeClass(c.classPrefix+"-wrapper").removeClass(c.classPrefix+"-"+c.aspect).css("position","");l.css("display",d)}if(!s.destroy){n=typeof n=="string"?l.find(n):n;if(!c){o=n.eq(0).is("li")?n.parent():n.wrapAll("<div />").parent();p=o.wrap("<div />").parent()}s.list=n;s.block=l;l.data("listscrollerCfg",s);l.addClass(s.classPrefix+"-active");p.addClass(s.classPrefix+"-wrapper").addClass(s.classPrefix+"-"+s.aspect);o.addClass(s.classPrefix+"-clip").add(p).css("position","relative");if(s.wrap=="loop"){s.flipover=n.slice(0,s.windowSize).clone(t).addClass("listscroller-clone");n.parent().append(s.flipover)}var f=[];if(s.controls!=="none"&&n.length>0){if(/^(above|both)$/.test(s.controls)){f.unshift(u(s).addClass(s.pagingTopClass)[0]);p.before(f[0])}if(/^(below|both)$/.test(s.controls)){f.unshift(u(s).addClass(s.pagingBottomClass)[0]);p.after(f[0])}}l.data("lstscr_pagingElms",e(f));if(s.aspect=="auto"){s.aspect=a(n)||e.listscroller.aspectDefaults[s.animation]||"horizontal"}p.addClass(s.classPrefix+"-"+s.aspect);if(s.startPos=="random"){s.startPos=Math.floor(Math.ceil(n.length/s.stepSize)*Math.random())*s.stepSize}i(s,s.startPos||0,{_noFlash:t,_noFocus:t});var m=s.autoScrollDelay;if(m){var v=function(e){i(s,s.index+s.stepSize,{_noFlash:t,_noFocus:t})};s.scrollTimeout=setTimeout(v,m);l.bind("mouseenter.lscr",function(e){l.addClass("block-mouseover");clearTimeout(s.scrollTimeout)}).bind("mouseleave.lscr",function(e){l.removeClass("block-mouseover");clearTimeout(s.scrollTimeout);s.scrollTimeout=setTimeout(v,m)}).bind("afterMove.lscr",function(e){if(!l.is(".block-mouseover")){clearTimeout(s.scrollTimeout);s.scrollTimeout=setTimeout(v,m)}})}}}e.fn.listscroller=function(t){var a=e.listscroller.defaultConfig;if(t&&(t.item||t.destroy)||a.item){this.each(function(){var l=e(this),i=l.closest("[lang]").attr("lang")||"",n=e.listscroller.i18n,r=n[i.toLowerCase()]||n[i.substr(0,2)]||n.en,o=e.extend({},a,r,t);if(o.itemStatusPager){o.inputPager=s}c(o,l,o.item)})}else if(this.length){this.eq(0).parent().listscroller(e.extend({},t,{item:this}))}return this}}(jQuery,!0,!1);
