// $.fn.delayedHighlight 1.0  -- (c) 2010-2013 Hugsmi√∞jan ehf.
(function(e,t){e.fn.delayedHighlight=function(i){if(this.length){i=e.extend({className:"focused",delay:500,delayOut:300,cancelOff:"a, area, :input"},i);var a=this,l=i.className,c=!("delegate"in i)?"li":i.delegate,r=i.holes,n="highlight",o=n+"on",s=n+"off",f="before"+o,u="before"+s,d=n+"-wasclicked",g="mouseover focusin",h="mouseout focusout",v="isDefaultPrevented",y=clearTimeout,m,k,b,p;if(i.noBubble){a.bind(f+" "+u+" "+o+" "+s,function(e){e.stopPropagation()})}var T=function(t){if(r&&e(t.target).closest(r,this)[0]){O.call(this,t)}else{var a=e(this);y(m);y(k);t.type.charAt(0)==="m"&&(p=this);m=setTimeout(function(){var e=b&&b[0],t;if(a[0]!==e){t=jQuery.Event(f);t.fromTarget=e;a.trigger(t);if(!t[v]()){if(b){b.removeClass(l).trigger(s)}b=a;a.addClass(l).trigger({type:o,fromTarget:e})}}},t.delayOut||i.delay)}},O=function(e){var a=e.type==="click";y(m);y(k);if(!i.sticky||a){e.type.charAt(0)==="m"&&(p=t);k=setTimeout(function(){if(b&&b[0]!==p||a){var e=jQuery.Event(u);b.trigger(e);if(!e[v]()){b.removeClass(l).trigger(s);b=t}}},e.delayOut||i.delayOut)}},C=function(a){var l=!b||this!==b[0]?T:i.clickToggles&&!e(a.target).closest(i.cancelOff||"")[0]?O:t;l&&l.call(this,{type:"click",delayOut:1})},D=function(){if(!b||this!==b[0]){var t=e(this);t.data(d,true);clearTimeout(t.data(d+"to"));t.data(d+"to",setTimeout(function(){t.removeData(d)},i.delay))}};c?a.delegate(c,g,T).delegate(c,h,O):a.bind(g,T).bind(h,O);if(i.click){c?a.delegate(c,"click",C):a.bind("click",C)}else if(i.clickCancels){c?a.delegate(c,"click",D):a.bind("click",D);a.bind(f,function(t){var i=e(t.target);if(i.data(d)){t.preventDefault();i.removeData(d)}})}}return this}})(jQuery);