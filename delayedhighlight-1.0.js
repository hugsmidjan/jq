// $.fn.delayedHighlight 1.0  -- (c) 2010-2013 Hugsmi√∞jan ehf.
(function(f,l){f.fn.delayedHighlight=function(b){if(this.length){b=f.extend({className:'focused',delay:500,delayOut:300,clickGrace:300,cancelOff:'a, area, :input'},b);var e=this,o=b.className,g=!('delegate'in b)?'li':b.delegate,x=b.holes,p='highlight',q=p+'on',m=p+'off',r='before'+q,y='before'+m,i=p+'-wasclicked',z='mouseover focusin',A='mouseout focusout',B='isDefaultPrevented',j=clearTimeout,s,t,c,u,C=b.clickGrace,D,v;if(b.noBubble){e.bind(r+' '+y+' '+q+' '+m,function(a){a.stopPropagation()})}var w=function(h){if(x&&f(h.target).closest(x,this)[0]){n.call(this,h)}else{var k=f(this);j(s);j(t);(h.type.charAt(0)==='m')&&(u=this);s=setTimeout(function(){var a=c&&c[0],d;if(k[0]!==a){d=jQuery.Event(r);d.fromTarget=a;k.trigger(d);if(!d[B]()){if(c){c.removeClass(o).trigger(m)}c=k;k.addClass(o).trigger({type:q,fromTarget:a});if(C){v=k[0];j(D);D=setTimeout(function(){v=l},C)}}}},h.delay||b.delay)}},n=function(d){var h=d.type==='click';j(s);j(t);if(!b.sticky||h){(d.type.charAt(0)==='m')&&(u=l);t=setTimeout(function(){if(c&&c[0]!==u||h){var a=jQuery.Event(y);c.trigger(a);if(!a[B]()){c.removeClass(o).trigger(m);c=l}}},d.delay||b.delayOut)}},E=function(a){var d=(!c||this!==c[0])?w:(b.clickToggles&&this!==v&&!f(a.target).closest(b.cancelOff||'')[0])?n:l;d&&d.call(this,{type:'click',delay:1})},F=function(){if(!c||this!==c[0]){var a=f(this);a.data(i,true);clearTimeout(a.data(i+'to'));a.data(i+'to',setTimeout(function(){a.removeData(i)},b.delay))}};g?e.delegate(g,z,w).delegate(g,A,n):e.bind(z,w).bind(A,n);if(b.click){g?e.delegate(g,'click',E):e.bind('click',E)}else if(b.clickCancels){g?e.delegate(g,'click',F):e.bind('click',F);e.bind(r,function(a){var d=f(a.target);if(d.data(i)){a.preventDefault();d.removeData(i)}})}}return this}})(jQuery);
