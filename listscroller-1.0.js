(function($){$.listscroller={version:1.0,defaultConfig:{item:'',windowSize:3,stepSize:1,startPos:0,hideClass:'overflow',topClass:'at-top',bottomClass:'at-bottom',wrap:'both',overflow:'hidden',controls:'below',animation:'none',easing:'swing',speed:600,aspect:'auto',paging:false,inputPager:false,initCallback:function(){},moveCallback:function(){},classPrefix:'listscroller',currentPageClass:'current',currentItemClass:'visible',cursorItemClass:'current',pagingTopClass:'paging-top',pagingBottomClass:'paging-bottom',pagingTemplate:'<div class="paging"><ul class="stepper"></ul></div>',nextBtnTemplate:'<li class="next"><a href="#"></a></li>',prevBtnTemplate:'<li class="prev"><a href="#"></a></li>',jumpTemplate:'<li class="jump"></li>',jumpLabelTemplate:'<strong></strong>',jumpWrapTemplate:'<span></span>',jumpBtnTemplate:'<a href="#"></a>',totalTemplate:'<b></b>',pagerTemplate:'<input type="text" value="" size="2" />',statusLabel:'Viewing results:',jumpLabel:'Pages:',ofTotalSeparator:' of ',labelNext:'Next',labelPrev:'Previous',titleNext:'Page forward',titlePrev:'Page back'},i18n:function(a,b){return a},animate:{none:function(l,c){},carousel:function(l,c){var p,w=$('.'+c.classPrefix+'-wrapper',this),z=l.eq(l.length-1),last=l.length-c.stepSize,prop=(c.aspect==='horizontal')?'scrollLeft':'scrollTop',dimp=(c.aspect==='horizontal')?'outerWidth':'outerHeight',conf={};w.stop();p=l.eq(c.index).position();conf[prop]=p.left;if(c.wrap=='loop'&&c.lastIndex==0&&c.index==last){w[prop](z.position().left+z[dimp]());w.animate(conf,c.speed,c.easing)}else if(c.wrap=='loop'&&c.lastIndex==last&&c.index==0){conf[prop]=z.position().left+z[dimp]();w.animate(conf,c.speed,c.easing,function(){w[prop](0)})}else{w.animate(conf,c.speed,c.easing)}},crossfade:function(l,c){l.each(function(i,a,b){a=(i>=c.index&&i<c.index+c.windowSize);b=(c.lastIndex==null)||(i>=c.lastIndex&&i<c.lastIndex+c.windowSize);if(a&&!b){$(this).stop().hide().fadeIn(c.speed)}else if(!a&&c.lastIndex==null){$(this).stop().hide()}else if(!a&&b){$(this).stop().show().fadeOut(c.speed)}})},accordion:function(l,c){var d,ap=(c.aspect=='vertical')?'height':'width';l.each(function(i,a,b){a=(i>=c.index&&i<c.index+c.windowSize);b=(c.lastIndex==null)||(i>=c.lastIndex&&i<c.lastIndex+c.windowSize);d={};if(a&&!b){d[ap]='show';$(this).stop().animate(d,c.speed,c.easing,function(){this.style[ap]=''})}else if(!a&&c.lastIndex==null){$(this).stop().hide()}else if(!a&&b){d[ap]='hide';$(this).stop().animate(d,c.speed,c.easing,function(){this.style[ap]=''})}})}},wrap:{none:function(i,l,c){return Math.max(Math.min(i,max(l,c)),0)},start:function(i,l,c){var m=max(l,c);if(i<0){return(c.index==0)?m:0}if(i>m){return m}return i},end:function(i,l,c){var m=max(l,c);if(i<0){return 0}if(i>m){return(c.index==m)?0:m}return i},both:function(i,l,c){var m=max(l,c);if(i<0){return(c.index==0)?m:0}if(i>m){return(c.index==m)?0:m}return i},random:function(i,l,c){return Math.floor(Math.random()*l.length)},loop:function(i,l,c){return((l.length+i)%l.length)}},aspectDefaults:{none:'vertical',carousel:'horizontal',crossfade:'horizontal',accordion:'vertical'}};function detectAspect(a){var b,i2=a.eq(1);p1=a.eq(0).offset(),p2=i2.offset();if(p2&&i2.is(':visible')){return(Math.abs(p2.top-p1.top)<=Math.abs(p2.left-p1.left))?'horizontal':'vertical'}return false}function max(l,c){return(c.overflow=='visible')?Math.floor(l.length/c.stepSize)*c.stepSize:l.length-c.windowSize}function setPos(c,a,b){var d=c.block;var e=c.list;c.lastIndex=c.index;c.index=$.listscroller.wrap[c.wrap||'none'](a,e,c);e.addClass(c.hideClass).removeClass(c.cursorItemClass).removeClass(c.currentItemClass).slice(c.index,c.index+c.windowSize).addClass(c.currentItemClass).removeClass(c.hideClass).eq(0).addClass(c.cursorItemClass);if($.isFunction(c.moveCallback)){c.moveCallback.call(d,e,c)}if($.isFunction(c.animation)){c.animation.call(d,e,c)}else{$.listscroller.animate[c.animation||'none'].call(d,e,c)}d.removeClass(c.topClass).removeClass(c.bottomClass);if(c.index==0){d.addClass(c.topClass)}if(c.index==e.length-c.windowSize){d.addClass(c.bottomClass)}if(!b){d.addClass(c.classPrefix+'-changed');setTimeout(function(){d.removeClass(c.classPrefix+'-changed')},c.speed||1)}if(c.jumps){c.jumps.removeClass(c.currentPageClass).eq(Math.ceil(c.index/c.stepSize)).addClass(c.currentPageClass)}else if(c.pager){c.pager.val(Math.ceil(c.index/c.stepSize)+1)}}function movePrev(e){var c=e.data;setPos(c,c.index-c.stepSize);return false}function moveNext(e){var c=e.data;setPos(c,c.index+c.stepSize);return false}function movePage(e){var c=e.data,p=(parseInt($(this).text(),10)-1)||0;setPos(c,p*c.stepSize);return false}function inputChange(e){var c=e.data,p=(parseInt($(this).val(),10)-1)||0;setPos(c,p*c.stepSize);return false}function buildControls(c,b){var n=$(c.nextBtnTemplate),p=$(c.prevBtnTemplate),j=$([]),i18n=$.listscroller.i18n;n.find('a').andSelf().eq(0).bind('click',c,moveNext).attr('title',i18n(c.titleNext,b)).text(i18n(c.labelNext,b));p.find('a').andSelf().eq(0).bind('click',c,movePrev).attr('title',i18n(c.titlePrev,b)).text(i18n(c.labelPrev,b));if(c.paging){var d=[],page=Math.ceil(c.index/c.stepSize),l=Math.ceil(c.list.length/c.stepSize);j=$(c.jumpTemplate);if(c.jumpLabelTemplate){$(c.jumpLabelTemplate).text(i18n(c.jumpLabel,b)).appendTo(j)}if(c.inputPager){c.pager=$(c.pagerTemplate).appendTo(j);j.append(c.ofTotalSeparator);var e=$(c.totalTemplate).appendTo(j);c.pager.bind('change',c,inputChange).val(page+1);e.text(l)}else{for(var i=0;i<l;i++){var f=$(c.jumpBtnTemplate),a=f.find('a').andSelf().eq(0).text(i+1).bind('click',c,movePage);if(c.index==i){a.addClass(c.currentPageClass)}d.push(a[0])}c.jumps=$(d);$(c.jumpWrapTemplate||[]).append(c.jumps).appendTo(j)}}var w=$(c.pagingTemplate);w.map(function(){var a=this;while(a.firstChild)a=a.firstChild;return a}).append(n,p,j);return w}function initScroller(c,a,b){if(a.hasClass(c.classPrefix+'-active')){return false}c.list=b;c.block=a;var d,_inner,_outer;if(b.eq(0).is('li')){_inner=b.parent()}else{_inner=b.wrapAll('<div />').parent()}_outer=_inner.wrap('<div />').parent();_inner.addClass(c.classPrefix+'-clip');_outer.addClass(c.classPrefix+'-wrapper');a.addClass(c.classPrefix+'-active');_inner.add(_outer).css('position','relative');_outer.addClass(c.classPrefix+'-'+c.aspect);if(c.wrap=='loop'){c.flipover=b.slice(0,c.windowSize).clone(true);b.parent().append(c.flipover)}if(c.controls!=='none'&&b.length>0){var e=b.parents('[lang]').attr('lang')||'en';if(/^(above|both)$/.test(c.controls)){_outer.before(buildControls(c,e).addClass(c.pagingTopClass))}if(/^(below|both)$/.test(c.controls)){_outer.after(buildControls(c,e).addClass(c.pagingBottomClass))}}if(c.aspect=='auto'){c.aspect=detectAspect(b)||$.listscroller.aspectDefaults[c.animation]||'horizontal'}_outer.addClass(c.classPrefix+'-'+c.aspect);setPos(c,c.startPos||0,true)}$.fn.listscroller=function(a){var d=$.listscroller.defaultConfig;if((a&&a.item)||d.item){this.each(function(){var c=$.extend({},d,a),b=$(this);initScroller(c,b,b.find(c.item))})}else if(this.length){initScroller($.extend({},d,a),this.eq(0).parent(),this)}return this}})(jQuery);