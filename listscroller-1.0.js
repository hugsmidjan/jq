(function($){$.listscroller={version:1,defaultConfig:{item:"",windowSize:3,stepSize:1,startPos:0,hideClass:"overflow",topClass:"at-top",bottomClass:"at-bottom",wrap:"both",overflow:"hidden",controls:"below",animation:"none",easing:"swing",speed:600,aspect:"auto",paging:false,initCallback:function(){},moveCallback:function(){},classPrefix:"listscroller",currentPageClass:"current",pagingTopClass:"paging-top",pagingBottomClass:"paging-bottom",pagingTemplate:'<div class="paging"><ul class="stepper"></ul></div>',nextBtnTemplate:'<li class="next"><a href="#"></a></li>',prevBtnTemplate:'<li class="prev"><a href="#"></a></li>',jumpTemplate:'<li class="jump"></li>',jumpLabelTemplate:"<strong></strong>",jumpWrapTemplate:"<span></span>",jumpBtnTemplate:'<a href="#"></a>',jumpLabel:"Pages:",labelNext:"Next",labelPrev:"Previous",titleNext:"Page forward",titlePrev:"Page back"},i18n:function(txt,lang){return txt},animate:{none:function(l,c){},carousel:function(l,c){var p,w=$("."+c.classPrefix+"-wrapper",this),z=l.eq(l.length-1),last=l.length-c.stepSize,prop=(c.aspect==="horizontal")?"scrollLeft":"scrollTop",dimp=(c.aspect==="horizontal")?"outerWidth":"outerHeight",conf={};w.stop();p=l.eq(c.index).position();conf[prop]=p.left+w[prop]();if(c.wrap=="loop"&&c.lastIndex==0&&c.index==last){w[prop](z.position().left+w[prop]()+z[dimp]());w.animate(conf,c.speed,c.easing)}else{if(c.wrap=="loop"&&c.lastIndex==last&&c.index==0){conf[prop]=z.position().left+z[dimp]()+w[prop]();w.animate(conf,c.speed,c.easing,function(){w.scrollLeft(0)})}else{w.animate(conf,c.speed,c.easing)}}},crossfade:function(l,c){l.each(function(i,nw,ow){nw=(i>=c.index&&i<c.index+c.windowSize);ow=(c.lastIndex==null)||(i>=c.lastIndex&&i<c.lastIndex+c.windowSize);if(nw&&!ow){$(this).stop().hide().fadeIn(c.speed)}else{if(!nw&&c.lastIndex==null){$(this).stop().hide()}else{if(!nw&&ow){$(this).stop().show().fadeOut(c.speed)}}}})},accordion:function(l,c){var ac,ap=(c.aspect=="vertical")?"height":"width";l.each(function(i,nw,ow){nw=(i>=c.index&&i<c.index+c.windowSize);ow=(c.lastIndex==null)||(i>=c.lastIndex&&i<c.lastIndex+c.windowSize);ac={};if(nw&&!ow){ac[ap]="show";$(this).stop().animate(ac,c.speed,c.easing)}else{if(!nw&&c.lastIndex==null){$(this).stop().hide()}else{if(!nw&&ow){ac[ap]="hide";$(this).stop().animate(ac,c.speed,c.easing)}}}})}},wrap:{none:function(i,l,c){return Math.max(Math.min(i,max(l,c)),0)},start:function(i,l,c){var m=max(l,c);if(i<0){return(c.index==0)?m:0}if(i>m){return m}return i},end:function(i,l,c){var m=max(l,c);if(i<0){return 0}if(i>m){return(c.index==m)?0:m}return i},both:function(i,l,c){var m=max(l,c);if(i<0){return(c.index==0)?m:0}if(i>m){return(c.index==m)?0:m}return i},random:function(i,l,c){return Math.floor(Math.random()*l.length)},loop:function(i,l,c){return((l.length+i)%l.length)}}};function max(l,c){return(c.overflow=="visible")?Math.floor(l.length/c.stepSize)*c.stepSize:l.length-c.windowSize}function setPos(c,_newIndex,_noflash){var _block=c.block;var list=c.list;c.lastIndex=c.index;c.index=$.listscroller.wrap[c.wrap||"none"](_newIndex,list,c);list.addClass(c.hideClass).slice(c.index,c.index+c.windowSize).removeClass(c.hideClass);if($.isFunction(c.moveCallback)){c.moveCallback.call(_block,list,c)}if($.isFunction(c.animation)){c.animation.call(_block,list,c)}else{$.listscroller.animate[c.animation||"none"].call(_block,list,c)}_block.removeClass(c.topClass).removeClass(c.bottomClass);if(c.index==0){_block.addClass(c.topClass)}if(c.index==list.length-c.windowSize){_block.addClass(c.bottomClass)}if(!_noflash){_block.addClass(c.classPrefix+"-changed");setTimeout(function(){_block.removeClass(c.classPrefix+"-changed")},c.speed||1)}if(c.jumps){c.jumps.removeClass(c.currentPageClass).eq(Math.ceil(c.index/c.stepSize)).addClass(c.currentPageClass)}}function movePrev(e){var c=e.data;setPos(c,c.index-c.stepSize);return false}function moveNext(e){var c=e.data;setPos(c,c.index+c.stepSize);return false}function movePage(e){var c=e.data,p=(parseInt($(this).text(),10)-1)||0;setPos(c,p*c.stepSize);return false}function buildControls(c,_lang){var n=$(c.nextBtnTemplate);var p=$(c.prevBtnTemplate);var j=$([]);var i18n=$.listscroller.i18n;n.find("a").andSelf().eq(0).bind("click",c,moveNext).attr("title",i18n(c.titleNext,_lang)).text(i18n(c.labelNext,_lang));p.find("a").andSelf().eq(0).bind("click",c,movePrev).attr("title",i18n(c.titlePrev,_lang)).text(i18n(c.labelPrev,_lang));if(c.paging){var jmps=[];page=Math.ceil(c.index/c.stepSize),l=Math.ceil(c.list.length/c.stepSize);for(var i=0;i<l;i++){var bt=$(c.jumpBtnTemplate);var a=bt.find("a").andSelf().eq(0).text(i+1).bind("click",c,movePage);if(c.index==i){a.addClass(c.currentPageClass)}jmps.push(a[0])}c.jumps=$(jmps);j=$(c.jumpTemplate);j.append($(c.jumpLabelTemplate||[]).text(i18n(c.jumpLabel,_lang)),$(c.jumpWrapTemplate||[]).append(c.jumps))}var w=$(c.pagingTemplate);w.map(function(){var elem=this;while(elem.firstChild){elem=elem.firstChild}return elem}).append(p,n,j);return w}function initScroller(c,_block,_items){if(_block.hasClass(c.classPrefix+"-active")){return false}c.list=_items;c.block=_block;var _ref,_inner,_outer;if(_items.eq(0).is("li")){_inner=_items.parent()}else{_inner=_items.wrapAll("<div />").parent()}_outer=_inner.wrap("<div />").parent();_inner.addClass(c.classPrefix+"-clip");_outer.addClass(c.classPrefix+"-wrapper");_block.addClass(c.classPrefix+"-active");if(c.aspect=="auto"){var p1=_items.eq(0).offset(),p2=_items.eq(1).offset();c.aspect=(p2&&(Math.abs(p2.top-p1.top)<=Math.abs(p2.left-p1.left)))?"horizontal":"vertical"}_outer.addClass(c.classPrefix+"-"+c.aspect);if(c.wrap=="loop"){c.flipover=_items.slice(0,c.windowSize).clone(true);_items.parent().append(c.flipover)}setPos(c,c.startPos||0,true);if(c.controls!=="none"&&_items.length>0){var _lang=_items.parents("[lang]").attr("lang")||"en";if(/^(above|both)$/.test(c.controls)){_outer.before(buildControls(c,_lang).addClass(c.pagingTopClass))}if(/^(below|both)$/.test(c.controls)){_outer.after(buildControls(c,_lang).addClass(c.pagingBottomClass))}}}$.fn.listscroller=function(config){var dc=$.listscroller.defaultConfig;if((config&&config.item)||dc.item){this.each(function(){var c=$.extend({},dc,config),b=$(this);initScroller(c,b,b.find(c.item))})}else{if(this.length){initScroller($.extend({},dc,config),this.eq(0).parent(),this)}}return this}})(jQuery);(function(a){a.listscroller={version:1,defaultConfig:{item:"",windowSize:3,stepSize:1,startPos:0,hideClass:"overflow",topClass:"at-top",bottomClass:"at-bottom",wrap:"both",overflow:"hidden",controls:"below",animation:"none",easing:"swing",speed:600,aspect:"auto",paging:false,inputPager:false,initCallback:function(){},moveCallback:function(){},classPrefix:"listscroller",currentPageClass:"current",currentItemClass:"visible",cursorItemClass:"current",pagingTopClass:"paging-top",pagingBottomClass:"paging-bottom",pagingTemplate:'<div class="paging"><ul class="stepper"></ul></div>',nextBtnTemplate:'<li class="next"><a href="#"></a></li>',prevBtnTemplate:'<li class="prev"><a href="#"></a></li>',jumpTemplate:'<li class="jump"></li>',jumpLabelTemplate:"<strong></strong>",jumpWrapTemplate:"<span></span>",jumpBtnTemplate:'<a href="#"></a>',totalTemplate:"<b></b>",pagerTemplate:'<input type="text" value="" size="2" />',statusLabel:"Viewing results:",jumpLabel:"Pages:",labelNext:"Next",labelPrev:"Previous",titleNext:"Page forward",titlePrev:"Page back"},i18n:function(k,m){return k;},animate:{none:function(k,m){},carousel:function(n,q){var m,s=a("."+q.classPrefix+"-wrapper",this),r=n.eq(n.length-1),t=n.length-q.stepSize,k=(q.aspect==="horizontal")?"scrollLeft":"scrollTop",u=(q.aspect==="horizontal")?"outerWidth":"outerHeight",o={};s.stop();m=n.eq(q.index).position();o[k]=m.left;if(q.wrap=="loop"&&q.lastIndex==0&&q.index==t){s[k](r.position().left+r[u]());s.animate(o,q.speed,q.easing);}else{if(q.wrap=="loop"&&q.lastIndex==t&&q.index==0){o[k]=r.position().left+r[u]();s.animate(o,q.speed,q.easing,function(){s[k](0);});}else{s.animate(o,q.speed,q.easing);}}},crossfade:function(k,m){k.each(function(p,n,o){n=(p>=m.index&&p<m.index+m.windowSize);o=(m.lastIndex==null)||(p>=m.lastIndex&&p<m.lastIndex+m.windowSize);if(n&&!o){a(this).stop().hide().fadeIn(m.speed);}else{if(!n&&m.lastIndex==null){a(this).stop().hide();}else{if(!n&&o){a(this).stop().show().fadeOut(m.speed);}}}});},accordion:function(k,o){var n,m=(o.aspect=="vertical")?"height":"width";k.each(function(r,p,q){p=(r>=o.index&&r<o.index+o.windowSize);q=(o.lastIndex==null)||(r>=o.lastIndex&&r<o.lastIndex+o.windowSize);n={};if(p&&!q){n[m]="show";a(this).stop().animate(n,o.speed,o.easing,function(){this.style[m]="";});}else{if(!p&&o.lastIndex==null){a(this).stop().hide();}else{if(!p&&q){n[m]="hide";a(this).stop().animate(n,o.speed,o.easing,function(){this.style[m]="";});}}}});}},wrap:{none:function(m,k,n){return Math.max(Math.min(m,d(k,n)),0);},start:function(o,n,p){var k=d(n,p);if(o<0){return(p.index==0)?k:0;}if(o>k){return k;}return o;},end:function(o,n,p){var k=d(n,p);if(o<0){return 0;}if(o>k){return(p.index==k)?0:k;}return o;},both:function(o,n,p){var k=d(n,p);if(o<0){return(p.index==0)?k:0;}if(o>k){return(p.index==k)?0:k;}return o;},random:function(m,k,n){return Math.floor(Math.random()*k.length);},loop:function(m,k,n){return((k.length+m)%k.length);}},aspectDefaults:{none:"vertical",carousel:"horizontal",crossfade:"horizontal",accordion:"vertical",}};function g(n){var k,m=n.eq(1);p1=n.eq(0).offset(),p2=m.offset();if(p2&&m.is(":visible")){console.log("item2 is visible and has offset");k=(Math.abs(p2.top-p1.top)<=Math.abs(p2.left-p1.left))?"horizontal":"vertical";}else{console.log("item2 is not visible, grab a good default");k=false;}return k;}function d(k,m){return(m.overflow=="visible")?Math.floor(k.length/m.stepSize)*m.stepSize:k.length-m.windowSize;}function j(p,n,m){var k=p.block;var o=p.list;p.lastIndex=p.index;p.index=a.listscroller.wrap[p.wrap||"none"](n,o,p);o.addClass(p.hideClass).removeClass(p.cursorItemClass).removeClass(p.currentItemClass).slice(p.index,p.index+p.windowSize).addClass(p.currentItemClass).removeClass(p.hideClass).eq(0).addClass(p.cursorItemClass);if(a.isFunction(p.moveCallback)){p.moveCallback.call(k,o,p);}if(a.isFunction(p.animation)){p.animation.call(k,o,p);}else{a.listscroller.animate[p.animation||"none"].call(k,o,p);}k.removeClass(p.topClass).removeClass(p.bottomClass);if(p.index==0){k.addClass(p.topClass);}if(p.index==o.length-p.windowSize){k.addClass(p.bottomClass);}if(!m){k.addClass(p.classPrefix+"-changed");setTimeout(function(){k.removeClass(p.classPrefix+"-changed");},p.speed||1);}if(p.jumps){p.jumps.removeClass(p.currentPageClass).eq(Math.ceil(p.index/p.stepSize)).addClass(p.currentPageClass);}else{if(p.pager){p.pager.val(Math.ceil(p.index/p.stepSize)+1);}}}function b(k){var m=k.data;j(m,m.index-m.stepSize);return false;}function f(k){var m=k.data;j(m,m.index+m.stepSize);return false;}function i(m){var n=m.data,k=(parseInt(a(this).text(),10)-1)||0;j(n,k*n.stepSize);return false;}function h(m){var n=m.data,k=(parseInt(a(this).val(),10)-1)||0;j(n,k*n.stepSize);return false;}function e(s,y){var o=a(s.nextBtnTemplate);var m=a(s.prevBtnTemplate);var q=a([]);var z=a.listscroller.i18n;o.find("a").andSelf().eq(0).bind("click",s,f).attr("title",z(s.titleNext,y)).text(z(s.labelNext,y));m.find("a").andSelf().eq(0).bind("click",s,b).attr("title",z(s.titlePrev,y)).text(z(s.labelPrev,y));if(s.paging){var k=[];page=Math.ceil(s.index/s.stepSize),l=Math.ceil(s.list.length/s.stepSize);q=a(s.jumpTemplate);if(s.jumpLabelTemplate){a(s.jumpLabelTemplate).text(z(s.jumpLabel,y)).appendTo(q);}if(s.inputPager){s.pager=a(s.pagerTemplate).appendTo(q);var t=a(s.totalTemplate).appendTo(q);s.pager.bind("change",s,h).val(page+1);t.text(l);}else{for(var r=0;r<l;r++){var x=a(s.jumpBtnTemplate);var u=x.find("a").andSelf().eq(0).text(r+1).bind("click",s,i);if(s.index==r){u.addClass(s.currentPageClass);}k.push(u[0]);}s.jumps=a(k);a(s.jumpWrapTemplate||[]).append(s.jumps).appendTo(q);}}var v=a(s.pagingTemplate);v.map(function(){var n=this;while(n.firstChild){n=n.firstChild;}return n;}).append(m,o,q);return v;}function c(r,k,p){if(k.hasClass(r.classPrefix+"-active")){return false;}r.list=p;r.block=k;var n,o,q;if(p.eq(0).is("li")){o=p.parent();}else{o=p.wrapAll("<div />").parent();}q=o.wrap("<div />").parent();o.addClass(r.classPrefix+"-clip");q.addClass(r.classPrefix+"-wrapper");k.addClass(r.classPrefix+"-active");o.add(q).css("position","relative");q.addClass(r.classPrefix+"-"+r.aspect);if(r.wrap=="loop"){r.flipover=p.slice(0,r.windowSize).clone(true);p.parent().append(r.flipover);}if(r.controls!=="none"&&p.length>0){var m=p.parents("[lang]").attr("lang")||"en";if(/^(above|both)$/.test(r.controls)){q.before(e(r,m).addClass(r.pagingTopClass));}if(/^(below|both)$/.test(r.controls)){q.after(e(r,m).addClass(r.pagingBottomClass));}}if(r.aspect=="auto"){r.aspect=g(p)||a.listscroller.aspectDefaults[r.animation]||"horizontal";}q.addClass(r.classPrefix+"-"+r.aspect);j(r,r.startPos||0,true);}a.fn.listscroller=function(m){var k=a.listscroller.defaultConfig;if((m&&m.item)||k.item){this.each(function(){var o=a.extend({},k,m),n=a(this);c(o,n,n.find(o.item));});}else{if(this.length){c(a.extend({},k,m),this.eq(0).parent(),this);}}return this;};})(jQuery);