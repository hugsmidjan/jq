// encoding: utf-8
// $.fn.curtain 1.0  -- (c) 2009 HugsmiÃ°jan ehf.
(function(b){var h='curtain',f='opacity',n=b[h]=function(a,d){if(a=='destroy'){var e=b.inArray(d,g);if(e>-1){b(d).remove();g.splice(e,1)}!g.length&&i.unbind('resize',m);return}if(a&&(a.tagName||a.jquery)){d=a;a={}}a=b.extend({className:h+'-overlay'},typeof(a)=='string'?{className:a}:typeof(a)=='boolean'&&a?{bg:'#888',opacity:.5,z:99}:a||{});b.browser.msie&&parseInt(b.browser.version,10)<7&&(a.fixed=0);var c=b(d||'<div />').hide().addClass(a.className).css({position:a.fixed?'fixed':'absolute',top:0,left:0,width:'100%',height:'100%'});if(!d||!d.parentNode){c.appendTo(document.body)}if(a.bg||a[f]||a.z){c.css({background:a.bg,opacity:a[f],zIndex:a.z})}if(!a.fixed){if(a[f]&&!b.support[f]&&c.css(f)==1){c.css(f,c.css('filter').match(/opacity=(\d+)/)?RegExp.$1/100:1)}g.push(c[0]);j=j||b('body');i.bind('resize',m);m(1)}return c};b.fn[h]=function(a){return this.each(function(){b[h](a,this)})};var g=[],i=b(window),j,m=function(a){var d=g.length,e=-1,c=e;while(d--){var k=g[d];if(k&&((k.parentNode&&b(k).is(':visible'))||a==1)){e=e!=-1?e:Math.max(i.width(),j.innerWidth());c=c!=-1?c:Math.max(i.height(),j.innerHeight());var l=k.style;l.width=l.height='0';l.width=e+'px';l.height=c+'px'}}}})(jQuery);
