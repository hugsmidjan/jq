/* $.fn.editedSeach 1.0  -- (c) 2016 Hugsmiðjan ehf. @preserve */
!function(e){var a=function(a,t){var n,c=a.find("input:text"),r=window.ga&&window.ga.eventPing?window.ga.eventPing:function(){},i=e.debounceFn(function(e){r("sitessearch-box","ac-result",e)},800);c.autocomplete({minLength:t.minSearchLength,delay:t.searchDelay,autoFocus:t.autoFocus,appendTo:a,source:function(a,c){var r=this.element,s=e(r[0].form);i.cancel(),n&&n.abort(),n=e.ajax({url:t.ajaxSearchUrl,data:s.serialize()+"&"+e.param(t.ajaxParams)}).done(function(n){var r=[];e(e.imgSuppress(n)).find(t.editedSearchSelextor+" a").each(function(a){var t=e(this);r.push({label:t.html(),url:t.attr("href"),pos:a+1})}),t.useGaPing&&i(a.term+" | curated:"+r.length),r.push({label:t.searchForText+' <strong>"'+a.term+'"</strong>',className:"search",searchAction:!0}),c(r)})},position:{},html:!0}).on("autocompletefocus",function(e){e.preventDefault()}).on("autocompleteselect",function(a,n){if(a.preventDefault(),n.item.searchAction){var c=e(this).autocomplete("widget").children().length;t.useGaPing&&r("sitessearch-box","ac-click-search",this.value+" | curated:"+c),e(this).closest("form").submit()}else t.useGaPing&&r("sitessearch-box","ac-click",this.value+" | listPos:"+n.item.pos+" | "+n.item.url),location.href=n.item.url})};e.fn.editedSeach=function(t){var n={ajaxSearchUrl:"/search",useGaPing:!1,searchForText:"is"===e.lang()?"Leita að ":"Search for ",ajaxParams:{justPicPos:"pgmain"},editedSearchSelextor:".curatedsearch",minSearchLength:1,searchDelay:200,autoFocus:!1},c=e.extend(n,t);return this.each(function(){a(e(this),c)})}}(jQuery);
