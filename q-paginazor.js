/* $.fn.paginazor  -- (c) 2018 Hugsmiðjan ehf.  @preserve */
!function(l){var e={pagingSel:".paging",triggerSel:".next a",ajaxSel:".articlelist",itemSel:".item",ajaxParams:"justPicPos=pgmain",loadingClassTarget:"html",loadLazyImages:!1,infinityLoad:!1,showPagesLeft:!1,maintainStatusOnBack:!0,clearStatusSelector:"a:not(.pgmain a)",articleIdAttr:"data-aid",scrollOffset:100,scrollSpeed:1,pagesLeftText:"is"===l.lang()?"síður eftir":"pages left",loadMoreText:"is"===l.lang()?"Hlaða fleiri greinum":"Load more articles"},t=window.sessionStorage,a=JSON.parse(t.getItem("pagingTarget")),g=a&&a.listId,s=a&&parseInt(a.pageNo,10),o=a&&a.itemNo,d=function(a,e,t){if(a.find(t.triggerSel).length){a.addClass("pagelist-active");var i=t.loadMoreText;if(t.showPagesLeft){var n=a.find(".status").text().match(/\d+/g);if(n&&n[1])i+=" <span>"+(parseInt(n[1],10)-parseInt(n[0],10))+" "+t.pagesLeftText+"</span>"}a.find(t.triggerSel).html(i)}else a.remove();e&&a.on("whenonscreen",function(){a.find(t.triggerSel).trigger("click.loadmore")}).whenOnScreen({live:!0,ranges:{visible:{top:"75%s"}}})},c=function(a){a.find("ins.image").on("whenonscreen",function(){l(this).off("whenonscreen").css({"background-image":"url("+l(this).attr("data-src")+")"}).parent().addClass("lazy-loaded")}).whenOnScreen({live:!0})};l.fn.paginazor=function(a){return a=l.extend(e,a),this.each(function(){l(this).data("paginazor-active")?window.console.warn("Warning: paginazor already running."):(function(i,n){var a=n.infinityLoad&&"notfirst"!==n.infinityLoad,r=1,e=document.location.pathname;g!==e&&(t.removeItem("pagingTarget"),s=o=null),n.loadLazyImages&&c(i.find(n.itemSel)),d(i.find(n.pagingSel),a,n),i.on("click.loadmore",n.pagingSel+" "+n.triggerSel,function(a){a.preventDefault(),l(n.loadingClassTarget).addClass("ajax-wait"),r++,l.get(l(this).attr("href"),n.ajaxParams).done(function(a){if(a=l(a).find(n.ajaxSel).find(n.itemSel+","+n.pagingSel),i.find(n.pagingSel).replaceWith(a),n.loadLazyImages&&c(a),i.trigger("listupdated",[{itemlist:a,page:r}]),d(i.find(n.pagingSel),n.infinityLoad,n),n.maintainStatusOnBack&&s)if(r<s)i.find(n.pagingSel+" "+n.triggerSel).trigger("click.loadmore");else if(s===r){var e=i.find('.item[data-aid="'+o+'"]');if(e.length){var t=e.offset().top-n.scrollOffset;l("html, body").animate({scrollTop:t},n.scrollSpeed),e.focusHere()}}}).always(function(){l(n.loadingClassTarget).removeClass("ajax-wait")})}),n.maintainStatusOnBack&&(i.on("click.setstatus",n.itemSel,function(){var a=l(this).attr(n.articleIdAttr);t.setItem("pagingTarget",JSON.stringify({pageNo:r,itemNo:a,listId:e}))}),s&&r<s&&i.find(n.pagingSel+" "+n.triggerSel).trigger("click.loadmore"),l(document).on("click.cleartarget",n.clearStatusSelector,function(){t.removeItem("pagingTarget")}))}(l(this),a),l(this).data("paginazor-active",!0))})}}(window.jQuery);
