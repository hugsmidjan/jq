/* $.fn.yearpicker 1.0  -- (c) 2018 Hugsmiðjan ehf. @preserve */
!function(t){var a=function(a,e){var r=a.find(e.inpSel).prop("readonly",!0),i=t('<ul class="yearpicker"></ul>'),s=parseInt(e.startYear,10),o=parseInt(e.endYear,10),l=!1,d=e.allowRange,c=[];o=o<=(s=s<1990?1990:s>=o?o-1:s)?s+1:o>2100?2100:o;for(var p=s;p<=o;p++)i.append('<li data-year="'+p+'"><button type="button">'+p+"</button></li>");r.val()&&(c=r.val().trim().split(" - "));var u={start:parseInt(c[0],10)||0,end:parseInt(c[1],10)||0};n(i,u,"active");var g=t('<button class="yptoggler" type="button">'+e.pickText+"</button>").on("click",function(t){t.stopPropagation(),l?(l=!1,a.removeClass("yp-open"),i.detach()):(l=!0,a.addClass("yp-open").append(i))}).appendTo(a),f=t('<button class="ypclear" type="button">x</button>').on("click",function(t){t.stopPropagation(),l&&g.trigger("click"),f.detach(),r.val(""),u.start=0,u.end=0,n(i,u,"active")});r.val()&&f.appendTo(a),i.on("click",function(t){t.stopPropagation()}).on("click","li",function(){var e=t(this),s=parseInt(e.data("year"),10),o="";u.start?s===u.start?d&&u.end?(u.start=u.end,u.end=0):u.start=0:s===u.end?u.end=0:s>u.start?d?u.end=s:u.start=s:s<u.start&&(d&&!u.end&&(u.end=u.start),u.start=s):u.start=s,n(i,u,"active"),e.trigger("mouseenter"),u.start&&(o=""+u.start,u.end&&(o+=" - "+u.end)),r.val(o),o?f.appendTo(a):f.detach()}).on("mouseenter","li",function(){if(d){var a=parseInt(t(this).data("year"),10),e={};u.start&&a>u.start?(e.start=u.start,e.end=a):u.start&&a<u.start?(e.start=a,e.end=u.start):e.start=u.start,n(i,e,"highlight")}}).on("mouseleave",function(){d&&i.find("li").removeClass("highlight")}),t(document).on("click",function(){l&&g.trigger("click")}),t(window).on("keyup",function(t){27===t.which&&l&&g.trigger("click")})},n=function(t,a,n){t.find("li").removeClass(n),e(t,a.start,a.end).addClass(n)},e=function(a,n,e){var r=n?a.find('li[data-year="'+n+'"]'):t(),i=n&&e?a.find('li[data-year="'+e+'"]'):null;return e&&(r=r.nextUntil(i).add(r).add(i)),r};t.fn.yearPicker=function(n){var e=new Date;return this.each(function(){var r=t(this),i={inpSel:"> input:text",allowRange:!1!==r.data("range"),startYear:r.data("start")||e.getFullYear()-10,endYear:r.data("end")||e.getFullYear(),pickText:"is"===t.lang()?"Velja ár":"Choose year"},s=t.extend(i,n);a(r,s)})}}(window.jQuery);
